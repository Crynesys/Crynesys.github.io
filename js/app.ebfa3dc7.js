!function(e){function t(t){for(var r,i,s=t[0],c=t[1],u=t[2],p=0,f=[];p<s.length;p++)i=s[p],a[i]&&f.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);f.length;)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={19:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,r){n=a[e]=[t,r]});t.push(n[2]=r);var o=document.getElementsByTagName("head")[0],s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=i.p+"js/"+({0:"vendors~html.mode~java.mode~javascript.mode~markdown.mode~php.mode~typescript.mode",1:"vendors~css.mode~html.mode~markdown.mode~php.mode",2:"vendors~html.mode~markdown.mode~php.mode",3:"vendors~typescript.mode",4:"vendors~php.mode",5:"vendors~javascript.mode",6:"vendors~java.mode",7:"vendors~html.mode",8:"vendors~css.mode",9:"vendors~markdown.mode",10:"vendors~json.mode",11:"vendors~react-ace",12:"sql.mode",13:"csharp.mode",14:"golang.mode",15:"ruby.mode",16:"python.mode",17:"cpp.mode"}[e]||e)+"."+{0:"e239f8ea",1:"907f6532",2:"1904daae",3:"5b9d17f0",4:"8baa479e",5:"ead79ea6",6:"a3f5cb2d",7:"9ff40ef6",8:"c8efe20e",9:"fdd88858",10:"c4e452b9",11:"48049b00",12:"23db919b",13:"939806e6",14:"bd88cca1",15:"f5b5950e",16:"fc6e4f9b",17:"f1d343c1"}[e]+".js";var c=setTimeout(function(){u({type:"timeout",target:s})},12e4);function u(t){s.onerror=s.onload=null,clearTimeout(c);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src,i=new Error("Loading chunk "+e+" failed.\n("+r+": "+o+")");i.type=r,i.request=o,n[1](i)}a[e]=void 0}}s.onerror=s.onload=u,o.appendChild(s)}return Promise.all(t)},i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;o.push([304,18]),n()}({14:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(292);n(755),n(750);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"success";o.a.newInstance({},function(r){r.notice({content:a.a.createElement("div",{className:"component-message"},a.a.createElement("i",{className:"iconfont icon-"+n}),a.a.createElement("span",null,e)),duration:t})})}t.a={success:function(e,t){i(e,t,"success")},error:function(e,t){i(e,t,"error")},warning:function(e,t){i(e,t,"warning")},info:function(e,t){i(e,t,"info")}}},19:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(14),a=n(28);function o(e,t={},{toast:n=!0}={}){return new Promise(o=>{a.a.emit(e,t,e=>{"string"==typeof e?(n&&r.a.error(e),o([e,null])):o([null,e])})})}},204:function(e,t,n){"use strict";n.d(t,"a",function(){return c});const r={default:n(399),apple:n(398),pcqq:n(397),mobileqq:n(396),momo:n(395),huaji:n(394)};let a="default";const o=document.createElement("audio"),i=document.createElement("source");i.setAttribute("type","audio/mp3"),i.setAttribute("src",r[a]),o.appendChild(i),document.body.appendChild(o);let s=!1;function c(e="default"){e!==a&&(i.setAttribute("src",r[e]),o.load(),a=e),s||(s=!0,o.play().then(()=>{s=!1}))}},28:function(e,t,n){"use strict";var r=n(303),a=n.n(r),o=n(29),i=new a.a(o.a.server,{});t.a=i},29:function(e,t,n){"use strict";t.a={server:"",maxImageSize:1048576,maxBackgroundImageSize:3145728,primaryColor:"74, 144, 226",primaryTextColor:"247, 247, 247",backgroundImage:n(637),sound:"default"}},295:function(e,t,n){"use strict";var r=n(11),a=n.n(r),o=n(0),i=n.n(o),s=n(129),c=(n(168),n(25)),u=n(2),l=n.n(u),p=n(5),f=n.n(p),d=n(205),m=n(82),h=n(63),g=n(100),y=n.n(g),v=n(98),b=n.n(v),w=n(8),k=n(28),E=(n(750),"http://identicon.org?t=avatar_0&s=256"),O=new Map;function S(){}function j(e){var t=O.get(e.target)||0;t>=2||(e.target.src=E,O.set(e.target,t+1))}var I=function(e){e.src;var t=e.size,n=void 0===t?60:t,r=e.onClick,a=void 0===r?S:r,o=e.className,s=void 0===o?"":o;return i.a.createElement("img",{className:"component-avatar "+s,src:"http://identicon.org?t={src}&s=256",style:{width:n,height:n,borderRadius:n/2},onClick:a,onError:j})};I.propTypes={src:l.a.string.isRequired,size:l.a.number,className:l.a.string,onClick:l.a.func};var C,x,_=I,P=n(32),D=n(37),N=n(31),T=n(14),A=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var R=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/sidebar/OnlineStatus.jsx",components:{OnlineStatus:{displayName:"OnlineStatus"}},locals:[],imports:[]});var L,M=(L="OnlineStatus",function(e){return R(e,L)})((x=C=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),A(t,[{key:"render",value:function(){var e=this.props,t=e.status,n=e.className;return i.a.createElement("div",{className:"module-main-sidebar-onlineStatus "+n},i.a.createElement("div",{className:t}))}}]),t}(),C.propTypes={status:l.a.oneOf(["online","offline"]),className:l.a.string},x)),z=n(83);async function G(e="blob",t="*/*"){const n=await new Promise(n=>{const r=document.createElement("input");r.style.display="none",r.setAttribute("type","file"),r.setAttribute("accept",t),r.onchange=(t=>{const r=t.target.files[0];if(!r)return;const a=new FileReader;switch(a.onloadend=function(){n({filename:r.name,ext:r.name.split(".").pop().toLowerCase(),type:r.type,result:this.result,length:"blob"===e?this.result.byteLength:this.result.length})},e){case"blob":a.readAsArrayBuffer(r);break;case"base64":a.readAsDataURL(r);break;default:a.readAsArrayBuffer(r)}}),r.click()});return"blob"===e&&(n.result=new Blob([new Uint8Array(n.result)],{type:n.type})),n}var U,F,V=n(204),B=n(29),$=(n(744),n(305),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}());function H(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}function q(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var K=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/ShowWalletInfo/index.jsx",components:{ShowWalletInfo:{displayName:"ShowWalletInfo"}},locals:[],imports:[]});var W,J,Q,Y=function(e){return function(t){return K(t,e)}}("ShowWalletInfo")((U=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=q(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),F.call(r),q(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.a.Component),$(t,[{key:"componentDidMount",value:function(){var e=this;if(!!window.NOS&&!!window.NOS.V1){var t=window.NOS.V1,n=null,r=null;t.getAddress().then(function(t){r=t,e.setState({address:t,_balance:n})}).catch(function(e){return alert("Error: "+e.message)}),t.getBalance({asset:"c56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b"}).then(function(t){n=t,e.setState({_address:r,balance:t})}).catch(function(e){return alert("Error: "+e.message)})}}},{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,i.a.createElement("p",null,"address: ",this.state.address),i.a.createElement("p",null,"balance: ",new Intl.NumberFormat("en-GB",{style:"decimal"}).format(this.state.balance)," NEO")))}}]),t}(),F=function(){var e,t,n,r,a=this;this.state={address:null,balance:null},this.handleGetAddress=H(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.props.nos.getAddress());case 1:case"end":return e.stop()}},e,a)})),this.handleClaimGas=function(){return a.props.nos.claimGas().then(alert).catch(alert)},this.handleGetBalance=(e=H(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.props.nos.getBalance(t));case 1:case"end":return e.stop()}},e,a)})),function(t){return e.apply(this,arguments)}),this.handleTestInvoke=(t=H(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.props.nos.testInvoke(t,n,r));case 1:case"end":return e.stop()}},e,a)})),function(e,n,r){return t.apply(this,arguments)}),this.handleInvoke=(n=H(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.props.nos.testInvoke(t,n,r));case 1:case"end":return e.stop()}},e,a)})),function(e,t,r){return n.apply(this,arguments)}),this.handleGetStorage=(r=H(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.props.nos.getStorage(t,n));case 1:case"end":return e.stop()}},e,a)})),function(e,t){return r.apply(this,arguments)})},U)),X=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Z(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}function ee(e,t,n,r,a){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var te=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/sidebar/Sidebar.jsx",components:{Sidebar:{displayName:"Sidebar"}},locals:[],imports:[]});var ne,re,ae=function(e){return function(t){return te(t,e)}}("Sidebar")((Q=J=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return o.state={settingDialog:!1,userDialog:!1,infoDialog:!1,avatarLoading:!1,backgroundLoading:!1},o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),X(t,null,[{key:"logout",value:function(){w.a.logout(),window.localStorage.removeItem("token"),T.a.success("Sei uscito"),k.a.disconnect(),k.a.connect()}},{key:"resetThume",value:function(){w.a.setPrimaryColor(B.a.primaryColor),w.a.setPrimaryTextColor(B.a.primaryTextColor),w.a.setBackgroundImage(B.a.backgroundImage),Object(z.a)(B.a.primaryColor,B.a.primaryTextColor),window.localStorage.removeItem("primaryColor"),window.localStorage.removeItem("primaryTextColor"),window.localStorage.removeItem("backgroundImage"),T.a.success("Tema predefinito ripristinato")}},{key:"resetSound",value:function(){w.a.setSound(B.a.sound),window.localStorage.removeItem("sound"),T.a.success("Tono predefinito ripristinato")}},{key:"handleSelectSound",value:function(e){Object(V.a)(e),w.a.setSound(e)}}]),X(t,[{key:"openSettingDialog",value:function(){this.setState({settingDialog:!0})}},{key:"closeSettingDialog",value:function(){this.setState({settingDialog:!1})}},{key:"openUserDialog",value:function(){this.setState({userDialog:!0})}},{key:"closeUserDialog",value:function(){this.setState({userDialog:!1})}},{key:"openInfo",value:function(){this.setState({infoDialog:!0})}},{key:"closeInfo",value:function(){this.setState({infoDialog:!1})}},{key:"handlePrimaryColorChange",value:function(e){var t=e.rgb.r+", "+e.rgb.g+", "+e.rgb.b,n=this.props.primaryTextColor;w.a.setPrimaryColor(e.rgb.r+", "+e.rgb.g+", "+e.rgb.b),Object(z.a)(t,n)}},{key:"handlePrimaryTextColorChange",value:function(e){var t=e.rgb.r+", "+e.rgb.g+", "+e.rgb.b,n=this.props.primaryColor;w.a.setPrimaryTextColor(e.rgb.r+", "+e.rgb.g+", "+e.rgb.b),Object(z.a)(n,t)}},{key:"toggleAvatarLoading",value:function(){this.setState({avatarLoading:!this.state.avatarLoading})}},{key:"selectAvatar",value:function(){var e=Z(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G("blob","image/png,image/jpeg,image/gif");case 2:if(!((t=e.sent).length>B.a.maxImageSize)){e.next=5;break}return e.abrupt("return",T.a.error("Impossibile impostare l'avatar, selezionare un'immagine inferiore a 1 MB"));case 5:this.toggleAvatarLoading(),k.a.emit("uploadToken",{},function(e){"string"==typeof e?T.a.error(e):m.upload(t.result,"Avatar/"+n.props.userId+"_"+Date.now(),e.token,{useCdnDomain:!0},{}).subscribe({error:function(e){console.error(e),T.a.error("Impossibile caricare l'immagine"),n.toggleAvatarLoading()},complete:function(r){var a=""+(e.urlPrefix+r.key);k.a.emit("changeAvatar",{avatar:a},function(e){"string"==typeof e?(T.a.error(e),n.toggleAvatarLoading()):(w.a.setAvatar(URL.createObjectURL(t.result)),T.a.success("Avatar Modificato con successo"),n.toggleAvatarLoading())})}})});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"toggleBackgroundLoading",value:function(){this.setState({backgroundLoading:!this.state.backgroundLoading})}},{key:"selectBackgroundImage",value:function(){var e=Z(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.toggleBackgroundLoading(),e.next=3,G("base64","image/png,image/jpeg,image/gif");case 3:if(!((t=e.sent).length>B.a.maxBackgroundImageSize)){e.next=6;break}return e.abrupt("return",T.a.error("Impossibile impostare l'immagine di sfondo.Seleziona un'immagine di dimensioni inferiori a 3 MB."));case 6:w.a.setBackgroundImage(t.result),this.toggleBackgroundLoading();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,n=e.isLogin,r=e.isConnect,a=e.avatar,o=e.primaryColor,s=e.primaryTextColor,c=e.backgroundImage,u=e.sound,l=e.soundSwitch,p=e.notificationSwitch,f=e.voiceSwitch,m=e.showNosAddress,g=this.state,v=g.settingDialog,k=g.userDialog,E=g.infoDialog,O=g.avatarLoading,S=g.backgroundLoading,j=window.hasOwnProperty("NOS");return n?i.a.createElement("div",{className:"module-main-sidebar"},i.a.createElement(_,{className:"avatar",src:a,onClick:this.openUserDialog}),i.a.createElement(M,{className:"status",status:r?"online":"offline"}),i.a.createElement("div",{className:"buttons"},i.a.createElement(P.a,{width:40,height:40,icon:"about",iconSize:26,onClick:this.openInfo}),i.a.createElement(P.a,{width:40,height:40,icon:"setting",iconSize:26,onClick:this.openSettingDialog}),i.a.createElement(P.a,{width:40,height:40,icon:"logout",iconSize:26,onClick:t.logout})),i.a.createElement(D.a,{className:"dialog system-setting",visible:v,title:"Impostazioni di sistema",onClose:this.closeSettingDialog},i.a.createElement("div",{className:"content"},i.a.createElement("div",null,i.a.createElement("p",null,"Ripristina"),i.a.createElement("div",{className:"buttons"},i.a.createElement(N.a,{onClick:t.resetThume},"Ripristina tema predefinito"),i.a.createElement(N.a,{onClick:t.resetSound},"Ripristina tono predefinito"))),i.a.createElement("div",null,i.a.createElement("p",null,"Imposta"),i.a.createElement("div",{className:"switch"},i.a.createElement("p",null,"Visualizza l'indirizzo"),i.a.createElement(y.a,{onChange:w.a.setNosAddress,checked:m}),i.a.createElement("p",null,"Promemoria sonoro"),i.a.createElement(y.a,{onChange:w.a.setSoundSwitch,checked:l}),i.a.createElement("p",null,"Promemoria desktop"),i.a.createElement(y.a,{onChange:w.a.setNotificationSwitch,checked:p}),i.a.createElement("p",null,"Messaggio Vocale"),i.a.createElement(y.a,{onChange:w.a.setVoiceSwitch,checked:f}))),i.a.createElement("div",null,i.a.createElement("p",null,"Tono Rapido"),i.a.createElement("div",{className:"sounds"},i.a.createElement(h.RadioGroup,{value:u,onChange:t.handleSelectSound,horizontal:!0},i.a.createElement(h.RadioButton,{value:"default"},"Default"),i.a.createElement(h.RadioButton,{value:"apple"},"Mela"),i.a.createElement(h.RadioButton,{value:"pcqq"},"Computer"),i.a.createElement(h.RadioButton,{value:"mobileqq"},"Mobile"),i.a.createElement(h.RadioButton,{value:"momo"},"via via"),i.a.createElement(h.RadioButton,{value:"huaji"},"Funny")))),i.a.createElement("div",null,i.a.createElement("p",null,"Immagine di sfondo ",i.a.createElement("span",{className:"background-tip"},"L'immagine di sfondo verrà estesa alle dimensioni della finestra del browser, un rapporto ragionevole otterrà risultati migliori")),i.a.createElement("div",{className:"image-preview"},i.a.createElement("img",{className:S?"blur":"",src:c,onClick:this.selectBackgroundImage}),i.a.createElement(b.a,{className:"loading "+(S?"show":"hide"),type:"spinningBubbles",color:"rgb("+o,height:100,width:100}))),i.a.createElement("div",null,i.a.createElement("p",null,"Colore del tema"),i.a.createElement("div",{className:"color-info"},i.a.createElement("div",{style:{backgroundColor:"rgb("+o+")"}}),i.a.createElement("span",null,"rgb("+o+")")),i.a.createElement(d.TwitterPicker,{className:"color-picker",color:"rgb("+o+")",onChange:this.handlePrimaryColorChange})),i.a.createElement("div",null,i.a.createElement("p",null,"Colore del testo"),i.a.createElement("div",{className:"color-info"},i.a.createElement("div",{style:{backgroundColor:"rgb("+s+")"}}),i.a.createElement("span",null,"rgb("+s+")")),i.a.createElement(d.TwitterPicker,{className:"color-picker",color:"rgb("+s+")",onChange:this.handlePrimaryTextColorChange})))),i.a.createElement(D.a,{className:"dialog selfInfo",visible:k,title:"Impostazioni delle informazioni personali",onClose:this.closeUserDialog},i.a.createElement("div",{className:"content"},i.a.createElement("div",null,j&&i.a.createElement(Y,null),i.a.createElement("p",null,"Avatar"),i.a.createElement("div",{className:"avatar-preview"},i.a.createElement("img",{className:O?"blur":"",src:a,onClick:this.selectAvatar}),i.a.createElement(b.a,{className:"loading "+(O?"show":"hide"),type:"spinningBubbles",color:"rgb("+o,height:80,width:80}))))),i.a.createElement(D.a,{className:"dialog fiora-info ",visible:E,title:"info",onClose:this.closeInfo},i.a.createElement("div",{className:"content"},i.a.createElement("div",null,i.a.createElement("p",null,"piccola Chat per gestire gruppi con interessi comuni")),i.a.createElement("div",null,i.a.createElement("p",null,"Accedendo dal client di nOS è possibile sfruttare le operazioni messe a disposizione per inviare asset tra memebri della chat erichiamare smart contract NEO."))))):i.a.createElement("div",{className:"module-main-sidebar"})}}]),t}(),J.propTypes={isLogin:l.a.bool.isRequired,isConnect:l.a.bool.isRequired,avatar:l.a.string,primaryColor:l.a.string,primaryTextColor:l.a.string,backgroundImage:l.a.string,userId:l.a.string,sound:l.a.string,soundSwitch:l.a.bool,notificationSwitch:l.a.bool,voiceSwitch:l.a.bool,showNosAddress:l.a.bool},ee((W=Q).prototype,"openSettingDialog",[f.a],Object.getOwnPropertyDescriptor(W.prototype,"openSettingDialog"),W.prototype),ee(W.prototype,"closeSettingDialog",[f.a],Object.getOwnPropertyDescriptor(W.prototype,"closeSettingDialog"),W.prototype),ee(W.prototype,"openUserDialog",[f.a],Object.getOwnPropertyDescriptor(W.prototype,"openUserDialog"),W.prototype),ee(W.prototype,"closeUserDialog",[f.a],Object.getOwnPropertyDescriptor(W.prototype,"closeUserDialog"),W.prototype),ee(W.prototype,"openInfo",[f.a],Object.getOwnPropertyDescriptor(W.prototype,"openInfo"),W.prototype),ee(W.prototype,"closeInfo",[f.a],Object.getOwnPropertyDescriptor(W.prototype,"closeInfo"),W.prototype),ee(W.prototype,"handlePrimaryColorChange",[f.a],Object.getOwnPropertyDescriptor(W.prototype,"handlePrimaryColorChange"),W.prototype),ee(W.prototype,"handlePrimaryTextColorChange",[f.a],Object.getOwnPropertyDescriptor(W.prototype,"handlePrimaryTextColorChange"),W.prototype),ee(W.prototype,"selectAvatar",[f.a],Object.getOwnPropertyDescriptor(W.prototype,"selectAvatar"),W.prototype),ee(W.prototype,"selectBackgroundImage",[f.a],Object.getOwnPropertyDescriptor(W.prototype,"selectBackgroundImage"),W.prototype),W)),oe=Object(c.b)(function(e){return{isLogin:!!e.getIn(["user","_id"]),isConnect:e.get("connect"),avatar:e.getIn(["user","avatar"]),userId:e.getIn(["user","_id"]),primaryColor:e.getIn(["ui","primaryColor"]),primaryTextColor:e.getIn(["ui","primaryTextColor"]),backgroundImage:e.getIn(["ui","backgroundImage"]),sound:e.getIn(["ui","sound"]),soundSwitch:e.getIn(["ui","soundSwitch"]),notificationSwitch:e.getIn(["ui","notificationSwitch"]),voiceSwitch:e.getIn(["ui","voiceSwitch"]),showNosAddress:e.getIn(["ui","showNosAddress"])}})(ae),ie=n(24),se=n.n(ie),ce=n(39),ue=n.n(ce),le={isToday:(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),isYesterday(e,t){const n=new Date(e);return n.setDate(e.getDate()-1),n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()},getHourMinute(e){const t=e.getHours(),n=e.getMinutes();return`${t<10?`0${t}`:t}:${n<10?`0${n}`:n}`},getMonthDate:e=>`${e.getMonth()+1}/${e.getDate()}`},pe=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var fe=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/featureLinkmans/Linkman.jsx",components:{Linkman:{displayName:"Linkman"}},locals:[],imports:[]});var de,me,he=function(e){return function(t){return fe(t,e)}}("Linkman")((re=ne=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),pe(t,[{key:"shouldComponentUpdate",value:function(e){return!(this.props.avatar===e.avatar&&this.props.name===e.name&&this.props.preview===e.preview&&this.props.unread===e.unread&&this.props.focus===e.focus)}},{key:"formatTime",value:function(){var e=this.props.time,t=new Date;return le.isToday(t,e)?le.getHourMinute(e):le.isYesterday(t,e)?"ieri":le.getMonthDate(e)}},{key:"render",value:function(){var e=this.props,t=e.avatar,n=e.name,r=e.preview,a=e.unread,o=e.focus,s=e.onClick;return i.a.createElement("div",{className:"module-main-feature-linkman "+(o?"focus":""),onClick:s},i.a.createElement(_,{src:t,size:48}),i.a.createElement("div",{className:"top-bottom"},i.a.createElement("div",{className:"name-time"},i.a.createElement("p",{className:"name"},n),i.a.createElement("p",{className:"time"},this.formatTime())),i.a.createElement("div",{className:"preview-unread"},i.a.createElement("p",{className:"preview",dangerouslySetInnerHTML:{__html:r}}),a>0?i.a.createElement("div",{className:"unread"},i.a.createElement("span",null,a)):null)))}}],[{key:"getZeroTime",value:function(e){var t=new Date(e);return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}}]),t}(),ne.propTypes={avatar:l.a.string.isRequired,name:l.a.string.isRequired,preview:l.a.string,time:l.a.object,unread:l.a.number.isRequired,focus:l.a.bool,onClick:l.a.func},re)),ge=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ye=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/featureLinkmans/LinkmanGroup.jsx",components:{LinkmanGroup:{displayName:"LinkmanGroup"}},locals:[],imports:[]});var ve=function(e){return function(t){return ye(t,e)}}("LinkmanGroup")((me=de=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),ge(t,[{key:"componentWillReceiveProps",value:function(e){0===this.props.linkmans.size&&0!==e.linkmans.size&&w.a.setFocus(e.linkmans.getIn(["0","_id"]))}},{key:"renderLinkman",value:function(e){var t=e.get("_id"),n=e.get("unread"),r=e.getIn(["messages",e.get("messages").size-1]),a=new Date(e.get("createTime")),o="Nessuna novità";return r&&(a=new Date(r.get("createTime")),o=""+r.get("content"),"group"===e.get("type")&&(o=r.getIn(["from","username"])+": "+o)),i.a.createElement(he,{key:t,name:e.get("name"),avatar:e.get("avatar"),preview:o,time:a,unread:n,focus:this.props.focus===t,onClick:w.a.setFocus.bind(null,t)})}},{key:"render",value:function(){var e=this,t=this.props.linkmans;return i.a.createElement("div",{className:"chatPanel-linkman-group"},t.map(function(t){return e.renderLinkman(t)}))}}]),t}(),de.propTypes={linkmans:ue.a.list,focus:l.a.string},me)),be=Object(c.b)(function(e){return{linkmans:e.getIn(["user","linkmans"])||se.a.List(),focus:e.get("focus")}})(ve),we=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ke,Ee,Oe,Se=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,N["a"]),we(t,[{key:"render",value:function(){var e=this.props,t=e.width,n=e.height,r=e.icon,a=e.iconSize,o=e.onClick,s=e.style;return i.a.createElement("div",{className:"component-FAButton",style:Object.assign({width:t,height:n},s),onClick:o},i.a.createElement("i",{className:"fas "+r,style:{fontSize:a,lineHeight:n+"px"}}))}}]),t}(),je=n(41),Ie=n(33),Ce=n(19),xe=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Pe(e,t,n,r,a){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var De=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/GroupInfo.jsx",components:{GroupInfo:{displayName:"GroupInfo"}},locals:[],imports:[]});var Ne,Te,Ae,Re=function(e){return function(t){return De(t,e)}}("GroupInfo")((Oe=Ee=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),_e(t,[{key:"handleJoinGroup",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){var t,n,r,a,o,i,s,c,u,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.groupInfo,(0,t.onClose)(),e.next=4,Object(Ce.a)("joinGroup",{groupId:n._id});case 4:if(r=e.sent,a=xe(r,2),o=a[0],i=a[1],o){e.next=18;break}return i.type="group",w.a.addLinkman(i,!0),e.next=13,Object(Ce.a)("getLinkmanHistoryMessages",{linkmanId:i._id,existCount:0});case 13:s=e.sent,c=xe(s,2),u=c[0],l=c[1],u||w.a.addLinkmanMessages(i._id,l);case 18:case"end":return e.stop()}},e,this)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})});return function(){return t.apply(this,arguments)}}()},{key:"handleFocusGroup",value:function(){var e=this.props,t=e.groupInfo;(0,e.onClose)(),w.a.setFocus(t._id)}},{key:"render",value:function(){var e=this.props,t=e.visible,n=e.groupInfo,r=e.onClose,a=e.linkmans;return i.a.createElement(D.a,{className:"info-dialog",visible:t,onClose:r},t&&n?i.a.createElement("div",{className:"content"},i.a.createElement("div",{className:"header"},i.a.createElement(_,{size:60,src:n.avatar}),i.a.createElement("p",null,n.name)),i.a.createElement("div",{className:"info"},i.a.createElement("div",null,i.a.createElement("p",null,"membri:"),i.a.createElement("div",null,n.members)),a.find(function(e){return e.get("_id")===n._id})?i.a.createElement(N.a,{onClick:this.handleFocusGroup},"Invia un messaggio"):i.a.createElement(N.a,{onClick:this.handleJoinGroup},"Unisciti al gruppo"))):null)}}]),t}(),Ee.propTypes={visible:l.a.bool,groupInfo:l.a.object,onClose:l.a.func,linkmans:ue.a.list},Pe((ke=Oe).prototype,"handleJoinGroup",[f.a],Object.getOwnPropertyDescriptor(ke.prototype,"handleJoinGroup"),ke.prototype),Pe(ke.prototype,"handleFocusGroup",[f.a],Object.getOwnPropertyDescriptor(ke.prototype,"handleFocusGroup"),ke.prototype),ke)),Le=Object(c.b)(function(e){return{linkmans:e.getIn(["user","linkmans"])}})(Re),Me=n(291),ze=(n(740),Me.a),Ge=n(47),Ue=(n(738),n(72)),Fe=n.n(Ue),Ve=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Be=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function $e(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}function He(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function qe(e,t,n,r,a){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var Ke=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/UserInfo.jsx",components:{UserInfo:{displayName:"UserInfo"}},locals:[],imports:[]});var We,Je=function(e){return function(t){return Ke(t,e)}}("UserInfo")((Ae=Te=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=r=He(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.nOSDropdown=i.a.createElement("div",{className:"feature-dropdown"},i.a.createElement(Ge.d,{onClick:r.handleFeatureMenuClick},i.a.createElement(Ge.c,{key:"neo"},"Invia NEO"),i.a.createElement(Ge.c,{key:"gas"},"Invia Gas"))),He(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),Be(t,[{key:"handleFocusUser",value:function(){var e=this.props,t=e.userInfo,n=e.userId;(0,e.onClose)(),w.a.setFocus(Fe()(t._id,n))}},{key:"handleAddFriend",value:function(){var e=$e(regeneratorRuntime.mark(function e(){var t,n,r,a,o,i,s,c,u,l,p,f,d,m,h,g,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.userInfo,r=t.userId,a=t.linkmans,o=t.onClose,e.next=3,Object(Ce.a)("addFriend",{userId:n._id});case 3:if(i=e.sent,s=Ve(i,2),c=s[0],u=s[1],c){e.next=20;break}return o(),l=Fe()(r,u._id),p=0,(f=a.find(function(e){return e.get("_id")===l&&"temporary"===e.get("type")}))?(p=f.get("messages").size,w.a.setFriend(l,r,n._id)):(d={_id:l,type:"friend",createTime:Date.now(),avatar:u.avatar,name:u.username,messages:[],unread:0,from:u.from,to:u.to},w.a.addLinkman(d,!0)),e.next=15,Object(Ce.a)("getLinkmanHistoryMessages",{linkmanId:l,existCount:p});case 15:m=e.sent,h=Ve(m,2),g=h[0],y=h[1],g||w.a.addLinkmanMessages(l,y);case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleDeleteFriend",value:function(){var e=$e(regeneratorRuntime.mark(function e(){var t,n,r,a,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.userInfo,r=t.userId,a=t.onClose,e.next=3,Object(Ce.a)("deleteFriend",{userId:n._id});case 3:o=e.sent,i=Ve(o,1),i[0]||(a(),w.a.removeLinkman(Fe()(r,n._id)),T.a.success("Non siete più amici"));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleFeatureMenuClick",value:function(e){var t=e.key,n=window.NOS.V1,r=this.props.userInfo,a=null,o=this.assetQty.getValue(),i=r.neoAddress;switch(t){case"neo":a="c56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b";break;case"gas":a="602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7"}n.send({asset:a,quantity:o,receiver:i}).then(function(e){return T.a.success(o+" NEO inviati, transazione "+e)}).catch(function(e){return T.a.error("Error: "+e.message)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.visible,r=t.userInfo,a=t.onClose,o=t.linkmans.find(function(e){return e.get("to")===r._id&&"friend"===e.get("type")}),s=(r.neoAddress,window.hasOwnProperty("NOS"));return i.a.createElement(D.a,{className:"dialog fiora-info ",visible:n,onClose:a},i.a.createElement("div",null,n&&r?i.a.createElement("div",{className:"content"},i.a.createElement("div",{className:"header"},i.a.createElement(_,{size:60,src:r.avatar}),i.a.createElement("p",null,r.username),i.a.createElement("br",null),s&&i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null," Address : ",r.neoAddress," "),i.a.createElement("br",null),i.a.createElement("p",null," quantità :  "),i.a.createElement(je.a,{ref:function(t){return e.assetQty=t}}),i.a.createElement("br",null),i.a.createElement(ze,{trigger:["click"],overlay:this.nOSDropdown,animation:"slide-up",placement:"topLeft"},i.a.createElement(P.a,{className:"send",width:44,height:44,icon:"send",iconSize:32})))),"5adad39555703565e7903f79"===r._id&&"robot10"!==r.username?i.a.createElement("div",{className:"info"},i.a.createElement("p",null,"Questo è un alieno")):i.a.createElement("div",{className:"info"},o?i.a.createElement(N.a,{onClick:this.handleFocusUser},"Invia un messaggio"):null,o?i.a.createElement(N.a,{type:"danger",onClick:this.handleDeleteFriend},"Elimina amico"):i.a.createElement(N.a,{onClick:this.handleAddFriend},"Aggiungi come amico"))):null))}}]),t}(),Te.propTypes={visible:l.a.bool,userInfo:l.a.object,onClose:l.a.func,linkmans:ue.a.list,userId:l.a.string},qe((Ne=Ae).prototype,"handleFocusUser",[f.a],Object.getOwnPropertyDescriptor(Ne.prototype,"handleFocusUser"),Ne.prototype),qe(Ne.prototype,"handleAddFriend",[f.a],Object.getOwnPropertyDescriptor(Ne.prototype,"handleAddFriend"),Ne.prototype),qe(Ne.prototype,"handleDeleteFriend",[f.a],Object.getOwnPropertyDescriptor(Ne.prototype,"handleDeleteFriend"),Ne.prototype),qe(Ne.prototype,"handleFeatureMenuClick",[f.a],Object.getOwnPropertyDescriptor(Ne.prototype,"handleFeatureMenuClick"),Ne.prototype),Ne)),Qe=Object(c.b)(function(e){return{linkmans:e.getIn(["user","linkmans"])||se.a.fromJS([]),userId:e.getIn(["user","_id"])}})(Je),Ye=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Xe=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Ze(e,t,n,r,a){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var et=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/featureLinkmans/Feature.jsx",components:{Feature:{displayName:"Feature"}},locals:[],imports:[]});var tt,nt,rt=function(e){return function(t){return et(t,e)}}("Feature")((Ze((We=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return o.state={showAddButton:!0,showCreateGroupDialog:!1,showSearchResult:!1,searchResultActiveKey:"all",searchResult:{users:[],groups:[]},showGroupInfo:!1,groupInfo:{},showUserInfo:!1,userInfo:{}},o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),Xe(t,[{key:"componentDidMount",value:function(){document.body.addEventListener("click",this.handleBodyClick.bind(this),!1)}},{key:"resetSearchView",value:function(){this.setState({showSearchResult:!1,showAddButton:!0,searchResultActiveKey:"all",searchResult:{users:[],groups:[]}}),this.searchInput.value=""}},{key:"handleBodyClick",value:function(e){if(e.target!==this.searchInput&&this.state.showSearchResult){var t=e.currentTarget,n=e.target;do{if(/search-result/.test(n.className))return;n=n.parentElement}while(n!==t);this.resetSearchView()}}},{key:"handleFocus",value:function(){this.setState({showAddButton:!1,showSearchResult:!0})}},{key:"showCreateGroupDialog",value:function(){this.setState({showCreateGroupDialog:!0})}},{key:"closeCreateGroupDialog",value:function(){this.setState({showCreateGroupDialog:!1})}},{key:"handleCreateGroup",value:function(){var e=this,t=this.groupName.getValue();k.a.emit("createGroup",{name:t},function(t){"string"==typeof t?T.a.error(t):(t.type="group",w.a.addLinkman(t,!0),e.groupName.clear(),e.closeCreateGroupDialog(),T.a.success("Gruppo creato con successo"))})}},{key:"search",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){var t,n,r,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.searchInput.value.trim(),e.next=3,Object(Ce.a)("search",{keywords:t});case 3:n=e.sent,r=Ye(n,2),a=r[0],o=r[1],a||this.setState({searchResult:{users:o.users,groups:o.groups}});case 8:case"end":return e.stop()}},e,this)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})});return function(){return t.apply(this,arguments)}}()},{key:"handleInputKeyDown",value:function(e){var t=this;"Enter"===e.key&&setTimeout(function(){t.search(),t.lastSearchTime=Date.now()},0)}},{key:"handleActiveKeyChange",value:function(e){this.setState({searchResultActiveKey:e})}},{key:"switchTabToUser",value:function(){this.setState({searchResultActiveKey:"user"})}},{key:"switchTabToGroup",value:function(){this.setState({searchResultActiveKey:"group"})}},{key:"openGroupInfoDialog",value:function(e){this.setState({showGroupInfo:!0,groupInfo:e}),this.resetSearchView()}},{key:"closeGroupInfoDialog",value:function(){this.setState({showGroupInfo:!1})}},{key:"openUserInfoDialog",value:function(e){this.setState({showUserInfo:!0,userInfo:e}),this.resetSearchView()}},{key:"closeUserInfoDialog",value:function(){this.setState({showUserInfo:!1})}},{key:"renderSearchUsers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,t=this.state.searchResult.users;e=Math.min(e,t.length);for(var n=[],r=0;r<e;r++)n.push(i.a.createElement("div",{key:t[r]._id,onClick:this.openUserInfoDialog.bind(this,t[r])},i.a.createElement(_,{size:40,src:t[r].avatar}),i.a.createElement("p",null,t[r].username)));return n}},{key:"renderSearchGroups",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,t=this.state.searchResult.groups;e=Math.min(e,t.length);for(var n=[],r=0;r<e;r++)n.push(i.a.createElement("div",{key:t[r]._id,onClick:this.openGroupInfoDialog.bind(this,t[r])},i.a.createElement(_,{size:40,src:t[r].avatar}),i.a.createElement("div",null,i.a.createElement("p",null,t[r].name),i.a.createElement("p",null,t[r].members," membri nel gruppo"))));return n}},{key:"render",value:function(){var e=this,t=this.state,n=t.showAddButton,r=t.showCreateGroupDialog,a=t.searchResult,o=t.showSearchResult,s=t.searchResultActiveKey,c=t.showGroupInfo,u=t.groupInfo,l=t.showUserInfo,p=t.userInfo,f=!!window.NOS&&!!window.NOS.V1;return i.a.createElement("div",{className:"chatPanel-feature"},i.a.createElement("input",{className:o?"focus":"blur",type:"text",placeholder:"Cerca gruppi / utenti",autoComplete:"false",ref:function(t){return e.searchInput=t},onFocus:this.handleFocus,onKeyDown:this.handleInputKeyDown}),i.a.createElement("i",{className:"iconfont icon-search"}),i.a.createElement(P.a,{style:{display:n?"block":"none"},width:40,height:40,icon:"add",iconSize:38,onClick:this.showCreateGroupDialog}),i.a.createElement(D.a,{className:"create-group-dialog",title:"Crea un gruppo",visible:r,onClose:this.closeCreateGroupDialog},i.a.createElement("div",{className:"content"},i.a.createElement("h3",null,"inserisci il nome del gruppo"),i.a.createElement(je.a,{ref:function(t){return e.groupName=t}}),f&&i.a.createElement(i.a.Fragment,null,i.a.createElement("br",null),i.a.createElement("h3",null,"inserisci l'indirizzo del gruppo"),i.a.createElement(je.a,{ref:function(t){return e.groupAddress=t}}),i.a.createElement("br",null),i.a.createElement(Se,{style:{display:n?"block":"none"},width:40,height:40,icon:"fa-book",iconSize:38,onClick:this.showCreateGroupDialog})),i.a.createElement("button",{onClick:this.handleCreateGroup},"Crea"))),i.a.createElement(Ie.d,{className:"search-result",style:{display:o?"block":"none"},activeKey:s,onChange:this.handleActiveKeyChange,renderTabBar:function(){return i.a.createElement(Ie.a,null)},renderTabContent:function(){return i.a.createElement(Ie.b,null)}},i.a.createElement(Ie.c,{tab:"completo",key:"all"},0===a.users.length&&0===a.groups.length?i.a.createElement("p",{className:"none"},"Nessun risultato, prova un'altra parola chiave"):i.a.createElement("div",{className:"all-list"},i.a.createElement("div",{style:{display:a.users.length>0?"block":"none"}},i.a.createElement("p",null,"utente"),i.a.createElement("div",{className:"user-list"},this.renderSearchUsers(3)),i.a.createElement("div",{className:"more",style:{display:a.users.length>3?"block":"none"}},i.a.createElement("span",{onClick:this.switchTabToUser},"Vedi di più"))),i.a.createElement("div",{style:{display:a.groups.length>0?"block":"none"}},i.a.createElement("p",null,"gruppi"),i.a.createElement("div",{className:"group-list"},this.renderSearchGroups(3)),i.a.createElement("div",{className:"more",style:{display:a.groups.length>3?"block":"none"}},i.a.createElement("span",{onClick:this.switchTabToGroup},"Vedi di più"))))),i.a.createElement(Ie.c,{tab:"utente",key:"user"},0===a.users.length?i.a.createElement("p",{className:"none"},"Nessun risultato, inserire altre parole chiave"):i.a.createElement("div",{className:"user-list only"},this.renderSearchUsers())),i.a.createElement(Ie.c,{tab:"gruppi",key:"group"},0===a.groups.length?i.a.createElement("p",{className:"none"},"Nessun risultato, inserire altre parole chiave"):i.a.createElement("div",{className:"group-list only"},this.renderSearchGroups()))),i.a.createElement(Le,{visible:c,groupInfo:u,onClose:this.closeGroupInfoDialog}),i.a.createElement(Qe,{visible:l,userInfo:p,onClose:this.closeUserInfoDialog}))}}]),t}()).prototype,"handleFocus",[f.a],Object.getOwnPropertyDescriptor(We.prototype,"handleFocus"),We.prototype),Ze(We.prototype,"showCreateGroupDialog",[f.a],Object.getOwnPropertyDescriptor(We.prototype,"showCreateGroupDialog"),We.prototype),Ze(We.prototype,"closeCreateGroupDialog",[f.a],Object.getOwnPropertyDescriptor(We.prototype,"closeCreateGroupDialog"),We.prototype),Ze(We.prototype,"handleCreateGroup",[f.a],Object.getOwnPropertyDescriptor(We.prototype,"handleCreateGroup"),We.prototype),Ze(We.prototype,"handleInputKeyDown",[f.a],Object.getOwnPropertyDescriptor(We.prototype,"handleInputKeyDown"),We.prototype),Ze(We.prototype,"handleActiveKeyChange",[f.a],Object.getOwnPropertyDescriptor(We.prototype,"handleActiveKeyChange"),We.prototype),Ze(We.prototype,"switchTabToUser",[f.a],Object.getOwnPropertyDescriptor(We.prototype,"switchTabToUser"),We.prototype),Ze(We.prototype,"switchTabToGroup",[f.a],Object.getOwnPropertyDescriptor(We.prototype,"switchTabToGroup"),We.prototype),Ze(We.prototype,"closeGroupInfoDialog",[f.a],Object.getOwnPropertyDescriptor(We.prototype,"closeGroupInfoDialog"),We.prototype),Ze(We.prototype,"closeUserInfoDialog",[f.a],Object.getOwnPropertyDescriptor(We.prototype,"closeUserInfoDialog"),We.prototype),Ze(We.prototype,"renderSearchUsers",[f.a],Object.getOwnPropertyDescriptor(We.prototype,"renderSearchUsers"),We.prototype),Ze(We.prototype,"renderSearchGroups",[f.a],Object.getOwnPropertyDescriptor(We.prototype,"renderSearchGroups"),We.prototype),We)),at=(n(736),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}());var ot=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/featureLinkmans/FeatureLinkmans.jsx",components:{FeatureLinkmans:{displayName:"FeatureLinkmans"}},locals:[],imports:[]});var it=function(e){return function(t){return ot(t,e)}}("FeatureLinkmans")((nt=tt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),at(t,[{key:"render",value:function(){var e=this.props.isLogin;return i.a.createElement("div",{className:"module-main-feature"},e?i.a.createElement(rt,null):null,i.a.createElement(be,null))}}]),t}(),tt.propTypes={isLogin:l.a.bool.isRequired},nt)),st=Object(c.b)(function(e){return{isLogin:!!e.getIn(["user","_id"])}})(it),ct=n(294),ut=(n(734),ct.a),lt=n(298),pt=n.n(lt);function ft(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"success";pt()({text:e,type:t,showConfirmButton:!0})}var dt,mt,ht=function(e,t){ft(e,t,"success")},gt=function(e,t){ft(e,t,"error")},yt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var vt=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/chat/HeaderBar.jsx",components:{HeaderBar:{displayName:"HeaderBar"}},locals:[],imports:[]});var bt,wt,kt,Et=function(e){return function(t){return vt(t,e)}}("HeaderBar")((mt=dt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),yt(t,[{key:"render",value:function(){var e=this.props,t=e.linkman,n=e.onShowInfo;return t?i.a.createElement("div",{className:"chat-headerBar"},i.a.createElement("h2",null,t&&t.get("name")),i.a.createElement("div",null,i.a.createElement(P.a,{width:40,height:40,icon:"gongneng",iconSize:24,onClick:n}))):i.a.createElement("div",null)}}]),t}(),dt.propTypes={linkman:ue.a.map,onShowInfo:l.a.func},mt)),Ot=Object(c.b)(function(e){var t=e.get("focus");return{linkman:(e.getIn(["user","linkmans"])||se.a.fromJS([])).find(function(e){return e.get("_id")===t})}})(Et),St=n(297),jt=n.n(St),It=(n(732),n(143)),Ct=(n(730),{default:["Oh","Haha","Task","Ah","Cool","Angry","Happy","Khan","Tear","Black Line","Despise","Unhappy","Awesome","Money","Question","Insidious","Spit","good","Grievance","Fascination","Hurrah","Laughing Eyes","Cold","Very Happy","Funny","Stubborn","Fantastic Khan","Well","Sleeping","Screaming","Rise up","Surprise","Spray","Love","Heartbreak","Rose","Gift","Star Moon","Sun","Music","Light bulb","Cake","Rainbow","Currency","Coffee","haha","Victory","thumbs","weak","ok"]}),xt=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_t=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Pt(e,t,n,r,a){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var Dt=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/chat/Message.jsx",components:{Message:{displayName:"Message"}},locals:[],imports:[]});var Nt=n(364);n(728),n(363),n(362),n(361),n(360),n(359),n(358),n(357),n(356),n(355),n(354),n(353),n(352),n(351),n(350),n(349),n(348),n(347);var Tt,At,Rt,Lt={javascript:"javascript",typescript:"typescript",java:"java",c_cpp:"cpp",python:"python",ruby:"ruby",php:"php",golang:"go",csharp:"csharp",html:"html",css:"css",markdown:"markdown",sql:"sql",json:"json"},Mt=function(e){return function(t){return Dt(t,e)}}("Message")((kt=wt=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},"code"===e.type?n.state.showCode=!1:"iamge"===e.type&&(n.state.showImage=!1),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),_t(t,null,[{key:"formatTime",value:function(e){var t=new Date;return le.isToday(t,e)?le.getHourMinute(e):le.isYesterday(t,e)?"ieri "+le.getHourMinute(e):le.getMonthDate(e)+" "+le.getHourMinute(e)}},{key:"convertExpression",value:function(e){return e.replace(/#\((.*)\)/g,function(e,t){var n=Ct.default.indexOf(t);return-1!==n?'<img class="expression-baidu" src="data:image/png;base64,R0lGODlhFAAUAIAAAP///wAAACH5BAEAAAAALAAAAAAUABQAAAIRhI+py+0Po5y02ouz3rz7rxUAOw==" style="background-position: left '+-30*n+'px;" onerror="this.style.display=\'none\'" alt="'+e+'">':e})}}]),_t(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.type,n=e.content,r=e.shouldScroll,a=e.isSelf;if("image"===t){var o=this.dom.clientWidth-100;o>500&&(o=500);var i=this.dom.querySelector(".img"),s=/width=([0-9]+)&height=([0-9]+)/.exec(n);if(s){var c=xt(s,3),u=c[1],l=c[2],p=1;u*p>o&&(p=o/u),l*p>400&&(p=400/l),i.width=u*p,i.height=l*p}}(r||a)&&this.dom.scrollIntoView()}},{key:"shouldComponentUpdate",value:function(e,t){return!(this.props.loading===e.loading&&this.props.percent===e.percent&&this.state.showCode===t.showCode&&this.state.showImage===t.showImage)}},{key:"showCode",value:function(){this.setState({showCode:!0})}},{key:"hideCode",value:function(){this.setState({showCode:!1})}},{key:"showImageViewer",value:function(){this.setState({showImage:!0})}},{key:"hideImageViewer",value:function(){this.setState({showImage:!1})}},{key:"handleClickAvatar",value:function(){var e=this.props,t=e.isSelf,n=e.openUserInfoDialog;t||n()}},{key:"renderText",value:function(){var e=this.props.content;return e=e.replace(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g,function(e){return'<a href="'+e+'" rel="noopener noreferrer" target="_blank">'+e+"</a>"}),i.a.createElement("div",{className:"text",dangerouslySetInnerHTML:{__html:t.convertExpression(e)}})}},{key:"renderImage",value:function(){var e=this.props,t=e.content,n=e.loading,r=e.percent,a=t;if(a.startsWith("blob")){var o=a.split("?");a=xt(o,1)[0]}return i.a.createElement("div",{className:"image "+(n?"loading":"")+" "+(/huaji=true/.test(t)?"huaji":"")},i.a.createElement("img",{className:"img",src:a,width:"1",height:"1",onDoubleClick:this.showImageViewer}),i.a.createElement(It.a,{className:"progress",percent:r,strokeWidth:"5",strokeColor:"#a0c672",trailWidth:"5"}),i.a.createElement("div",{className:"progress-number"},Math.ceil(r),"%"),i.a.createElement(jt.a,{visible:this.state.showImage,onClose:this.hideImageViewer,onMaskClick:this.hideImageViewer,images:[{src:a,alt:a}],noNavbar:!0}))}},{key:"renderCode",value:function(){var e=this.props.content,t=/@language=([_a-z]+)@/.exec(e);if(!t)return i.a.createElement("pre",{className:"code"},"Linguaggio di programmazione non supportato");var n=Lt[t[1]],r=e.replace(/@language=[_a-z]+@/,""),a=Nt.highlight(r,Nt.languages[n],n),o=r.length+"B";return r.length>1024&&(o=Math.ceil(r.length/1024*100)/100+"KB"),i.a.createElement("div",{className:"code"},i.a.createElement("div",{className:"button",onClick:this.showCode},i.a.createElement("div",null,i.a.createElement("div",{className:"icon"},i.a.createElement("i",{className:"iconfont icon-code"})),i.a.createElement("div",{className:"code-info"},i.a.createElement("span",null,n),i.a.createElement("span",null,o))),i.a.createElement("p",null,"Vista")),i.a.createElement(D.a,{className:"code-viewer",title:"Controlla il codice",visible:this.state.showCode,onClose:this.hideCode},i.a.createElement("pre",{className:"pre",dangerouslySetInnerHTML:{__html:a}})))}},{key:"renderUrl",value:function(){var e=this.props.content;return i.a.createElement("a",{href:e,target:"_black",rel:"noopener noreferrer"},e)}},{key:"renderContent",value:function(){switch(this.props.type){case"text":return this.renderText();case"image":return this.renderImage();case"code":return this.renderCode();case"url":return this.renderUrl();default:return i.a.createElement("div",{className:"unknown"},"Tipo di messaggio non supportato")}}},{key:"render",value:function(){var e=this,n=this.props,r=n.avatar,a=n.nickname,o=n.time,s=n.type,c=n.isSelf,u=n.tag;return i.a.createElement("div",{className:"chat-message "+(c?"self":"")+" "+s,ref:function(t){return e.dom=t}},i.a.createElement(_,{className:"avatar",src:r,size:44,onClick:this.handleClickAvatar}),i.a.createElement("div",{className:"right"},i.a.createElement("div",{className:"nickname-time"},i.a.createElement("span",{className:"tag",style:{display:u?"inline-block":"none"}},u),i.a.createElement("span",{className:"nickname"},a),i.a.createElement("span",{className:"time"},t.formatTime(o))),i.a.createElement("div",{className:"content"},this.renderContent()),i.a.createElement("div",{className:"arrow"})))}}]),t}(),wt.propTypes={avatar:l.a.string.isRequired,nickname:l.a.string.isRequired,time:l.a.object.isRequired,type:l.a.oneOf(["text","image","url","code"]),content:l.a.string.isRequired,isSelf:l.a.bool,loading:l.a.bool,percent:l.a.number,openUserInfoDialog:l.a.func,shouldScroll:l.a.bool,tag:l.a.string},wt.defaultProps={isSelf:!1},Pt((bt=kt).prototype,"showCode",[f.a],Object.getOwnPropertyDescriptor(bt.prototype,"showCode"),bt.prototype),Pt(bt.prototype,"hideCode",[f.a],Object.getOwnPropertyDescriptor(bt.prototype,"hideCode"),bt.prototype),Pt(bt.prototype,"showImageViewer",[f.a],Object.getOwnPropertyDescriptor(bt.prototype,"showImageViewer"),bt.prototype),Pt(bt.prototype,"hideImageViewer",[f.a],Object.getOwnPropertyDescriptor(bt.prototype,"hideImageViewer"),bt.prototype),Pt(bt.prototype,"handleClickAvatar",[f.a],Object.getOwnPropertyDescriptor(bt.prototype,"handleClickAvatar"),bt.prototype),bt)),zt=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Gt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Ut=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/chat/MessageList.jsx",components:{MessageList:{displayName:"MessageList"}},locals:[],imports:[]});function Ft(){}var Vt,Bt,$t,Ht,qt,Kt,Wt=function(e){return function(t){return Ut(t,e)}}("MessageList")((Rt=At=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return o.isFetching=!1,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),Gt(t,[{key:"handleScroll",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var n,r,a,o,i,s,c,u,l,p,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.target===this.$list){e.next=2;break}return e.abrupt("return");case 2:if(!this.isFetching){e.next=4;break}return e.abrupt("return");case 4:if(n=this.props,r=n.focus,a=n.messages,o=n.self,!(0===(i=t.target).scrollTop&&i.scrollHeight>i.clientHeight)){e.next=27;break}if(this.isFetching=!0,s=null,c=null,!o){e.next=19;break}return e.next=13,Object(Ce.a)("getLinkmanHistoryMessages",{linkmanId:r,existCount:a.size});case 13:u=e.sent,l=zt(u,2),s=l[0],c=l[1],e.next=25;break;case 19:return e.next=21,Object(Ce.a)("getDefalutGroupHistoryMessages",{existCount:a.size});case 21:p=e.sent,f=zt(p,2),s=f[0],c=f[1];case 25:s||w.a.addLinkmanMessages(r,c),this.isFetching=!1;case 27:case"end":return e.stop()}},e,this)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})});return function(e){return t.apply(this,arguments)}}()},{key:"renderMessage",value:function(e){var t=this.props.self,n={key:e.get("_id"),avatar:e.getIn(["from","avatar"]),nickname:e.getIn(["from","username"]),time:new Date(e.get("createTime")),type:e.get("type"),content:e.get("content"),isSelf:t===e.getIn(["from","_id"]),tag:e.getIn(["from","tag"]),openUserInfoDialog:Ft,shouldScroll:this.$list.scrollHeight===this.$list.clientHeight||0===this.$list.scrollTop||this.$list.scrollTop>this.$list.scrollHeight-2*this.$list.clientHeight};return"image"===n.type&&(n.loading=e.get("loading"),n.percent=e.get("percent")),!n.isSelf&&t&&(n.openUserInfoDialog=this.props.showUserInfoDialog.bind(this,e.get("from").toJS())),i.a.createElement(Mt,n)}},{key:"render",value:function(){var e=this,t=this.props.messages;return i.a.createElement("div",{className:"chat-messageList",onScroll:this.handleScroll,ref:function(t){return e.$list=t}},t.map(function(t){return e.renderMessage(t)}))}}]),t}(),At.propTypes={self:l.a.string,messages:ue.a.list,focus:l.a.string,showUserInfoDialog:l.a.func},Vt=(Tt=Rt).prototype,Bt="handleScroll",$t=[f.a],Ht=Object.getOwnPropertyDescriptor(Tt.prototype,"handleScroll"),qt=Tt.prototype,Kt={},Object.keys(Ht).forEach(function(e){Kt[e]=Ht[e]}),Kt.enumerable=!!Kt.enumerable,Kt.configurable=!!Kt.configurable,("value"in Kt||Kt.initializer)&&(Kt.writable=!0),Kt=$t.slice().reverse().reduce(function(e,t){return t(Vt,Bt,e)||e},Kt),qt&&void 0!==Kt.initializer&&(Kt.value=Kt.initializer?Kt.initializer.call(qt):void 0,Kt.initializer=void 0),void 0===Kt.initializer&&(Object.defineProperty(Vt,Bt,Kt),Kt=null),Tt)),Jt=Object(c.b)(function(e){var t=!!e.getIn(["user","_id"]),n=se.a.List();if(!t)return{self:"",messages:e.getIn(["user","linkmans",0,"messages"])||n};var r=e.getIn(["user","_id"]),a=e.get("focus"),o=e.getIn(["user","linkmans"]).find(function(e){return e.get("_id")===a});return o&&(n=o.get("messages")),{self:r,focus:a,messages:n}})(Wt),Qt=b.a;const Yt={0:`${n(346)}?width=250&height=250&huaji=true`,1:`${n(345)}?width=300&height=300&huaji=true`,2:`${n(344)}?width=245&height=206&huaji=true`,3:`${n(343)}?width=225&height=225&huaji=true`,4:`${n(342)}?width=224&height=225&huaji=true`,5:`${n(341)}?width=400&height=400&huaji=true`,6:`${n(340)}?width=284&height=177&huaji=true7`,7:`${n(339)}?width=300&height=300&huaji=true`,8:`${n(338)}?width=225&height=225&huaji=true`,9:`${n(337)}?width=204&height=247&huaji=true`,10:`${n(336)}?width=223&height=226&huaji=true`,11:`${n(335)}?width=198&height=255&huaji=true`,12:`${n(334)}?width=212&height=237&huaji=true`,13:`${n(333)}?width=290&height=174&huaji=true`,14:`${n(332)}?width=224&height=224&huaji=true`,15:`${n(331)}?width=224&height=224&huaji=true`,16:`${n(330)}?width=225&height=225&huaji=true`,17:`${n(329)}?width=225&height=225&huaji=true`,18:`${n(328)}?width=224&height=224&huaji=true`,19:`${n(327)}?width=225&height=225&huaji=true`,20:`${n(326)}?width=225&height=225&huaji=true`,21:`${n(325)}?width=225&height=225&huaji=true`,22:`${n(324)}?width=245&height=206&huaji=true`,23:`${n(323)}?width=225&height=225&huaji=true`,24:`${n(322)}?width=225&height=225&huaji=true`,25:`${n(321)}?width=225&height=225&huaji=true`,26:`${n(320)}?width=225&height=225&huaji=true`,27:`${n(319)}?width=180&height=180&huaji=true`,28:`${n(318)}?width=235&height=215&huaji=true`,29:`${n(317)}?width=278&height=182&huaji=true`,30:`${n(316)}?width=228&height=221&huaji=true`,31:`${n(315)}?width=239&height=211&huaji=true`},Xt=Object.keys(Yt).length;function Zt(){const e=Math.floor(Math.random()*Xt);return Yt[e]}var en,tn,nn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function rn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var an=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/chat/Expression.jsx",components:{Expression:{displayName:"Expression"}},locals:[],imports:[]});var on,sn,cn,un=n(314),ln=function(e){return function(t){return an(t,e)}}("Expression")((tn=en=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=r=rn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.handleClick=function(e){var t=e.currentTarget.dataset.name,n=r.props.onSelect;n&&n(t)},r.renderDefaultExpression=function(){return i.a.createElement("div",{className:"default-expression"},Ct.default.map(function(e,t){return i.a.createElement("div",{key:t,"data-name":e,onClick:r.handleClick},i.a.createElement("div",{className:"image",style:{backgroundPosition:"left "+-30*t+"px",backgroundImage:"url("+un+")"}}))}))},rn(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),nn(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"chat-expression"},i.a.createElement(Ie.d,{defaultActiveKey:"default",renderTabBar:function(){return i.a.createElement(Ie.a,null)},renderTabContent:function(){return i.a.createElement(Ie.b,null)}},i.a.createElement(Ie.c,{tab:"default",key:"default"},this.renderDefaultExpression())))}}]),t}(),en.propTypes={onSelect:l.a.func},tn)),pn=n(101),fn=(n(726),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),dn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function mn(e,t,n,r,a){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}function hn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function yn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var vn=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/chat/CodeEditor.jsx",components:{AceEditorWrap:{displayName:"AceEditorWrap",isInFunction:!0},CodeEditor:{displayName:"CodeEditor"}},locals:[],imports:[]});function bn(e){return function(t){return vn(t,e)}}var wn=["javascript","typescript","java","c_cpp","python","ruby","php","golang","csharp","html","css","markdown","sql","json"],kn=null,En=!1,On={};function Sn(e,t){return bn("AceEditorWrap")(function(r){function a(){var t;hn(this,a);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];var i=gn(this,(t=a.__proto__||Object.getPrototypeOf(a)).call.apply(t,[this].concat(r)));return i.state={editorReady:En,modeReady:!!On[e]},i}return yn(a,o["Component"]),dn(a,[{key:"componentDidMount",value:function(){var r=this,a=this.state,o=a.editorReady,i=a.modeReady;o?i||(t.call(this),On[e]=!0):(n.e(11).then(function(a){kn=n(201).default,n(200),n(199),r.setState({editorReady:!0}),t.call(r),On[e]=!0}.bind(null,n)).catch(n.oe),En=!0)}},{key:"render",value:function(){var t=this.state,n=t.editorReady,r=t.modeReady;return n&&r?i.a.createElement(kn,fn({mode:e},this.props)):i.a.createElement("span",{tip:"loading..."},i.a.createElement("div",{className:"loadinng"}))}}]),a}())}var jn,In,Cn,xn=Sn("javascript",function(){var e=this;Promise.all([n.e(0),n.e(5)]).then(function(t){n(198),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),_n=Sn("typescript",function(){var e=this;Promise.all([n.e(0),n.e(3)]).then(function(t){n(197),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),Pn=Sn("java",function(){var e=this;Promise.all([n.e(0),n.e(6)]).then(function(t){n(196),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),Dn=Sn("c_cpp",function(){var e=this;n.e(17).then(function(t){n(195),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),Nn=Sn("python",function(){var e=this;n.e(16).then(function(t){n(194),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),Tn=Sn("ruby",function(){var e=this;n.e(15).then(function(t){n(193),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),An=Sn("php",function(){var e=this;Promise.all([n.e(0),n.e(1),n.e(2),n.e(4)]).then(function(t){n(192),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),Rn=Sn("golang",function(){var e=this;n.e(14).then(function(t){n(191),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),Ln=Sn("csharp",function(){var e=this;n.e(13).then(function(t){n(190),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),Mn=Sn("html",function(){var e=this;Promise.all([n.e(0),n.e(1),n.e(2),n.e(7)]).then(function(t){n(189),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),zn=Sn("css",function(){var e=this;Promise.all([n.e(1),n.e(8)]).then(function(t){n(188),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),Gn=Sn("markdown",function(){var e=this;Promise.all([n.e(0),n.e(1),n.e(2),n.e(9)]).then(function(t){n(187),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),Un=Sn("sql",function(){var e=this;n.e(12).then(function(t){n(186),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),Fn=Sn("json",function(){var e=this;n.e(10).then(function(t){n(185),e.setState({modeReady:!0})}.bind(null,n)).catch(n.oe)}),Vn=bn("CodeEditor")((cn=sn=function(e){function t(){var e;hn(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=gn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return o.state={value:"",lang:wn[0]},o.shouldComponentUpdate=s.shouldComponentUpdate,o}return yn(t,o["Component"]),dn(t,[{key:"getValue",value:function(){return this.state.value}},{key:"getLanguage",value:function(){return this.state.lang}},{key:"handleSelectLanguage",value:function(e){this.setState({lang:e})}},{key:"handleChange",value:function(e){this.setState({value:e})}},{key:"renderEditor",value:function(){var e=this.state,t=e.value,n=e.lang,r={theme:"tomorrow",onChange:this.handleChange,fontSize:12,height:"100%",showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,value:t,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,tabSize:4}};switch(n){case"javascript":return i.a.createElement(xn,r);case"typescript":return i.a.createElement(_n,r);case"java":return i.a.createElement(Pn,r);case"c_cpp":return i.a.createElement(Dn,r);case"python":return i.a.createElement(Nn,r);case"ruby":return i.a.createElement(Tn,r);case"php":return i.a.createElement(An,r);case"golang":return i.a.createElement(Rn,r);case"csharp":return i.a.createElement(Ln,r);case"html":return i.a.createElement(Mn,r);case"css":return i.a.createElement(zn,r);case"markdown":return i.a.createElement(Gn,r);case"sql":return i.a.createElement(Un,r);case"json":return i.a.createElement(Fn,r);default:return null}}},{key:"render",value:function(){return i.a.createElement("div",{className:"chat-codeEditor"},i.a.createElement("div",{className:"select-container"},i.a.createElement("h3",null,"Linguaggio di programmazione: "),i.a.createElement(pn.b,{className:"language-select",defaultValue:wn[0],onSelect:this.handleSelectLanguage},wn.map(function(e){return i.a.createElement(pn.a,{value:e,key:e},e)}))),i.a.createElement("div",{className:"editor-container"},this.renderEditor()))}}]),t}(),sn.propTypes={onSend:l.a.func},mn((on=cn).prototype,"handleSelectLanguage",[f.a],Object.getOwnPropertyDescriptor(on.prototype,"handleSelectLanguage"),on.prototype),mn(on.prototype,"handleChange",[f.a],Object.getOwnPropertyDescriptor(on.prototype,"handleChange"),on.prototype),mn(on.prototype,"renderEditor",[f.a],Object.getOwnPropertyDescriptor(on.prototype,"renderEditor"),on.prototype),on)),Bn=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),$n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Hn(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}function qn(e,t,n,r,a){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var Kn=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/chat/ChatInput.jsx",components:{ChatInput:{displayName:"ChatInput"}},locals:[],imports:[]});var Wn,Jn,Qn,Yn=n(311),Xn=n(306),Zn=function(e){return function(t){return Kn(t,e)}}("ChatInput")((Cn=In=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return o.expressionDropdown=i.a.createElement("div",{className:"expression-dropdown"},i.a.createElement(ln,{onSelect:o.handleSelectExpression})),o.featureDropdown=i.a.createElement("div",{className:"feature-dropdown"},i.a.createElement(Ge.d,{onClick:o.handleFeatureMenuClick},i.a.createElement(Ge.c,{key:"expression"},"Invia emoticon"),i.a.createElement(Ge.c,{key:"image"},"Invia foto"),i.a.createElement(Ge.c,{key:"code"},"Invia il codice"))),o.nOSDropdown=i.a.createElement("div",{className:"feature-dropdown"},i.a.createElement(Ge.d,{onClick:o.handleFeatureMenuClick},i.a.createElement(Ge.c,{key:"neo"},"Invia NEO"),i.a.createElement(Ge.c,{key:"gas"},"Invia Gas"))),o.state={expressionVisible:!1,codeInputVisible:!1,expressionSearchVisible:!1,expressionSearchLoading:!1,expressionSearchResults:[]},o.lockEnter=!1,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),$n(t,null,[{key:"handleLogin",value:function(){w.a.showLoginDialog()}},{key:"insertAtCursor",value:function(e,t){if(document.selection){e.focus();var n=document.selection.createRange();n.text=t,n.select()}else if(e.selectionStart||"0"===e.selectionStart){var r=e.selectionStart,a=e.selectionEnd,o=e.scrollTop;e.value=e.value.substring(0,r)+t+e.value.substring(a,e.value.length),o>0&&(e.scrollTop=o),e.focus(),e.selectionStart=r+t.length,e.selectionEnd=r+t.length}else e.value+=t,e.focus()}},{key:"compressImage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return new Promise(function(r){var a=document.createElement("canvas");a.width=e.width,a.height=e.height,a.getContext("2d").drawImage(e,0,0),a.toBlob(r,t,n)})}}]),$n(t,[{key:"handleVisibleChange",value:function(e){this.setState({expressionVisible:e})}},{key:"handleFeatureMenuClick",value:function(e){switch(e.key){case"image":this.handleSelectFile();break;case"huaji":this.sendHuaji();break;case"code":this.setState({codeInputVisible:!0});break;case"expression":this.setState({expressionSearchVisible:!0})}}},{key:"handleCodeEditorClose",value:function(){this.setState({codeInputVisible:!1})}},{key:"closeExpressionSearch",value:function(){this.setState({expressionSearchVisible:!1})}},{key:"handleSendCode",value:function(){if(!this.props.connect)return T.a.error("Impossibile inviare un messaggio, al momento sei offline");var e=this.codeEditor.getLanguage(),t=this.codeEditor.getValue();if(""===t)return T.a.warning("Inserire il codice da inviare");var n="@language="+e+"@"+t,r=this.addSelfMessage("code",n);this.sendMessage(r,"code",n),this.handleCodeEditorClose()}},{key:"handleInputKeyDown",value:function(e){var t={1:"#(Sinister)",2:"#(good)",3:"#(funny)",4:"#(Ha ha)",5:"#(Verdict)",6:"#(laugh)",7:"#(tongue)","¡ ":"#(Sinister)",TM:"#(Well)","£":"#(funny)","¢":"#(Oh)","∞":"#(grievance)","§":"#(laughing)","¶":"#(Tongue)"};if("Tab"===e.key)e.preventDefault();else if("Enter"!==e.key||this.lockEnter){if("s"===e.key||"ß"===e.key)e.altKey&&(this.sendHuaji(),e.preventDefault());else if("d"===e.key||"∂"===e.key)e.altKey&&this.setState({expressionSearchVisible:!0});else if(t[e.key]&&e.altKey){if(!this.props.connect)return T.a.error("Impossibile inviare un messaggio, al momento sei offline");var n=this.addSelfMessage("text",t[e.key]);this.sendMessage(n,"text",t[e.key]),e.preventDefault()}}else this.sendTextMessage()}},{key:"sendTextMessage",value:function(){if(!this.props.connect)return T.a.error("Impossibile inviare un messaggio, al momento sei offline");var e=this.message.value.trim();if(0!==e.length){var t=this.addSelfMessage("text",Yn(e));this.sendMessage(t,"text",e),this.message.value=""}}},{key:"addSelfMessage",value:function(e,t){var n=this.props,r=n.user,a=n.focus,o=a+Date.now(),i={_id:o,type:e,content:t,createTime:Date.now(),from:{_id:r.get("_id"),username:r.get("username"),avatar:r.get("avatar")},loading:!0};return"image"===e&&(i.percent=0),w.a.addLinkmanMessage(a,i),o}},{key:"sendMessage",value:function(e,t,n){var r=this.props.focus;k.a.emit("sendMessage",{to:r,type:t,content:n},function(t){"string"==typeof t?T.a.error(t):(t.loading=!1,w.a.updateSelfMessage(r,e,t))})}},{key:"handleSelectExpression",value:function(e){this.handleVisibleChange(!1),t.insertAtCursor(this.message,"#("+e+")")}},{key:"sendImageMessage",value:function(e){var t=this;if(e.length>B.a.maxImageSize)return T.a.warning("L'immagine da inviare è troppo grande",3);var n=this.props,r=n.user,a=n.focus,o=e.type.split("/").pop().toLowerCase(),i=URL.createObjectURL(e.result),s=new Image;s.onload=function(){var n=t.addSelfMessage("image",i+"?width="+s.width+"&height="+s.height);k.a.emit("uploadToken",{},function(i){"string"==typeof i?T.a.error(i):m.upload(e.result,"ImageMessage/"+r.get("_id")+"_"+Date.now()+"."+o,i.token,{useCdnDomain:!0},{}).subscribe({next:function(e){w.a.updateSelfMessage(a,n,{percent:e.total.percent})},error:function(e){console.error(e),T.a.error("Impossibile caricare l'immagine")},complete:function(e){var r=i.urlPrefix+e.key+"?width="+s.width+"&height="+s.height;t.sendMessage(n,"image",r)}})})},s.src=i}},{key:"handleSelectFile",value:function(){var e=Hn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.connect){e.next=2;break}return e.abrupt("return",T.a.error("Impossibile inviare un messaggio, al momento sei offline"));case 2:return e.next=4,G("blob","image/png,image/jpeg,image/gif");case 4:t=e.sent,this.sendImageMessage(t);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sendHuaji",value:function(){var e=Hn(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=Zt(),n=this.addSelfMessage("image",t),this.sendMessage(n,"image",t);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handlePaste",value:function(e){var n=this;if(!this.props.connect)return e.preventDefault(),T.a.error("Impossibile inviare un messaggio, al momento sei offline");var r=(e.clipboardData||e.originalEvent.clipboardData).items;if((e.clipboardData||e.originalEvent.clipboardData).types.indexOf("Files")>-1){for(var a=0;a<r.length;a++){var o=r[a];"file"===o.kind&&function(){var e=o.getAsFile();if(e){var r=n,a=new FileReader;a.onloadend=function(){var n=this,a=new Image;a.onload=Hn(regeneratorRuntime.mark(function o(){var i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.compressImage(a,e.type,.8);case 2:i=n.sent,r.sendImageMessage({filename:e.name,ext:i.type.split("/").pop(),length:i.size,type:i.type,result:i});case 4:case"end":return n.stop()}},o,n)})),a.src=this.result},a.readAsDataURL(e)}}()}e.preventDefault()}}},{key:"handleIMEStart",value:function(){this.lockEnter=!0}},{key:"handleIMEEnd",value:function(){this.lockEnter=!1}},{key:"searchExpression",value:function(){var e=Hn(regeneratorRuntime.mark(function e(t){var n,r,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=10;break}return this.setState({expressionSearchLoading:!0}),e.next=4,Object(Ce.a)("searchExpression",{keywords:t});case 4:n=e.sent,r=Bn(n,2),a=r[0],o=r[1],a||this.setState({expressionSearchResults:o}),this.setState({expressionSearchLoading:!1});case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSearchExpressionButtonClick",value:function(){var e=this.expressionSearchKeyword.getValue();this.searchExpression(e)}},{key:"handleSearchExpressionInputEnter",value:function(e){this.searchExpression(e)}},{key:"handleClickExpression",value:function(e){var t=e.target;if("IMG"===t.tagName){var n=Xn.addParam(t.src,{width:t.naturalWidth,height:t.naturalHeight}),r=this.addSelfMessage("image",n);this.sendMessage(r,"image",n),this.setState({expressionSearchVisible:!1})}}},{key:"render",value:function(){var e=this,n=this.state,r=n.expressionVisible,a=n.codeInputVisible,o=n.expressionSearchVisible,s=n.expressionSearchResults,c=n.expressionSearchLoading;return this.props.isLogin?i.a.createElement("div",{className:"chat-chatInput"},i.a.createElement(ze,{trigger:["click"],visible:r,onVisibleChange:this.handleVisibleChange,overlay:this.expressionDropdown,animation:"slide-up",placement:"topLeft"},i.a.createElement(P.a,{className:"expression",width:44,height:44,icon:"expression",iconSize:32})),i.a.createElement(ze,{trigger:["click"],overlay:this.featureDropdown,animation:"slide-up",placement:"topLeft"},i.a.createElement(P.a,{className:"feature",width:44,height:44,icon:"feature",iconSize:32})),i.a.createElement(D.a,{className:"codeEditor-dialog",title:"Si prega di inserire il codice da inviare",visible:a,onClose:this.handleCodeEditorClose},i.a.createElement("div",{className:"container"},i.a.createElement(Vn,{ref:function(t){return e.codeEditor=t}}),i.a.createElement("button",{className:"codeEditor-button",onClick:this.handleSendCode},"Inviare"))),i.a.createElement(D.a,{className:"expressionSearch-dialog",title:"Cerca emoticon",visible:o,onClose:this.closeExpressionSearch},i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:"input-container"},i.a.createElement(je.a,{ref:function(t){return e.expressionSearchKeyword=t},onEnter:this.handleSearchExpressionInputEnter}),i.a.createElement(N.a,{onClick:this.handleSearchExpressionButtonClick},"ricerca")),i.a.createElement("div",{className:"loading "+(c?"show":"hide")},i.a.createElement(Qt,{type:"spinningBubbles",color:"#4A90E2",height:100,width:100})),i.a.createElement("div",{className:"expression-list",onClick:this.handleClickExpression},s.map(function(e,t){return i.a.createElement("img",{src:e.url,key:t+e.id})})))),i.a.createElement("input",{type:"text",placeholder:"",maxLength:"2048",ref:function(t){return e.message=t},onKeyDown:this.handleInputKeyDown,onPaste:this.handlePaste,onCompositionStart:this.handleIMEStart,onCompositionEnd:this.handleIMEEnd}),i.a.createElement(P.a,{className:"send",width:44,height:44,icon:"send",iconSize:32,onClick:this.sendTextMessage})):i.a.createElement("div",{className:"chat-chatInput guest"},i.a.createElement("p",null,"effettuare il ",i.a.createElement("b",{onClick:t.handleLogin},"Login")," per entrare nella chat"))}}]),t}(),In.propTypes={isLogin:l.a.bool.isRequired,focus:l.a.string,user:ue.a.map,connect:l.a.bool},qn((jn=Cn).prototype,"handleVisibleChange",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handleVisibleChange"),jn.prototype),qn(jn.prototype,"handleFeatureMenuClick",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handleFeatureMenuClick"),jn.prototype),qn(jn.prototype,"handleCodeEditorClose",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handleCodeEditorClose"),jn.prototype),qn(jn.prototype,"closeExpressionSearch",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"closeExpressionSearch"),jn.prototype),qn(jn.prototype,"handleSendCode",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handleSendCode"),jn.prototype),qn(jn.prototype,"handleInputKeyDown",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handleInputKeyDown"),jn.prototype),qn(jn.prototype,"sendTextMessage",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"sendTextMessage"),jn.prototype),qn(jn.prototype,"sendMessage",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"sendMessage"),jn.prototype),qn(jn.prototype,"handleSelectExpression",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handleSelectExpression"),jn.prototype),qn(jn.prototype,"handleSelectFile",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handleSelectFile"),jn.prototype),qn(jn.prototype,"sendHuaji",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"sendHuaji"),jn.prototype),qn(jn.prototype,"handlePaste",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handlePaste"),jn.prototype),qn(jn.prototype,"handleIMEStart",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handleIMEStart"),jn.prototype),qn(jn.prototype,"handleIMEEnd",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handleIMEEnd"),jn.prototype),qn(jn.prototype,"handleSearchExpressionButtonClick",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handleSearchExpressionButtonClick"),jn.prototype),qn(jn.prototype,"handleSearchExpressionInputEnter",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handleSearchExpressionInputEnter"),jn.prototype),qn(jn.prototype,"handleClickExpression",[f.a],Object.getOwnPropertyDescriptor(jn.prototype,"handleClickExpression"),jn.prototype),jn)),er=Object(c.b)(function(e){return{isLogin:!!e.getIn(["user","_id"]),connect:e.get("connect"),focus:e.get("focus"),user:e.get("user")}})(Zn),tr=(n(724),function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),nr=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function rr(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}function ar(e,t,n,r,a){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var or=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/chat/Chat.jsx",components:{Chat:{displayName:"Chat"}},locals:[],imports:[]});var ir=function(e){return function(t){return or(t,e)}}("Chat")((Qn=Jn=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return o.nOSDropdown=i.a.createElement("div",{className:"feature-dropdown"},i.a.createElement(Ge.d,{onClick:o.handleFeatureMenuClick},i.a.createElement(Ge.c,{key:"neo"},"Invia NEO"),i.a.createElement(Ge.c,{key:"gas"},"Invia Gas"))),o.state={groupInfoDialog:!1,userInfoDialog:!1,userInfo:{}},o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),nr(t,[{key:"componentDidMount",value:function(){document.body.addEventListener("click",this.handleBodyClick.bind(this),!1)}},{key:"handleFeatureMenuClick",value:function(e){var t=e.key,n=window.NOS.V1,r=null,a=this.assetQty.getValue(),o="AZ81H31DMWzbSnFDLFkzh9vHwaDLayV7fU";switch(t){case"neo":r="c56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b";break;case"gas":r="602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7"}console.log("asset: "+r+" amount: "+a+" receiver: "+o),n.send({asset:r,amount:a,receiver:o}).then(function(e){return ht(a+" NEO inviati, transazione "+e,3)}).catch(function(e){console.log(e.message),console.log(e),gt("Error: "+e.message)})}},{key:"handleBodyClick",value:function(e){if(this.state.groupInfoDialog){var t=e.currentTarget,n=e.target;do{if(/float-panel/.test(n.className))return;n=n.parentElement}while(n!==t);this.closeGroupInfo()}}},{key:"groupInfoDialog",value:function(){var e=rr(regeneratorRuntime.mark(function e(t){var n,r,a,o,i,s,c,u,l,p,f,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props,r=n.focus,a=n.userId,t.stopPropagation(),t.preventDefault(),o=null,i=null,null,s=null,!a){e.next=22;break}return e.next=10,Object(Ce.a)("getGroupOnlineMembers",{groupId:r});case 10:return c=e.sent,u=tr(c,2),o=u[0],i=u[1],e.next=16,Object(Ce.a)("getGroupInfos",{groupId:r});case 16:l=e.sent,p=tr(l,2),p[0],s=p[1],e.next=28;break;case 22:return e.next=24,Object(Ce.a)("getDefaultGroupOnlineMembers",{});case 24:f=e.sent,d=tr(f,2),o=d[0],i=d[1];case 28:o||w.a.setGroupMembers(r,i),s?this.setState({groupInfoDialog:!0,nosAddress:s.nosAddress}):this.setState({groupInfoDialog:!0});case 30:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"closeGroupInfo",value:function(){this.setState({groupInfoDialog:!1})}},{key:"showUserInfoDialog",value:function(e){this.setState({userInfoDialog:!0,userInfo:e})}},{key:"closeUserInfoDialog",value:function(){this.setState({userInfoDialog:!1})}},{key:"changeGroupAvatar",value:function(){var e=rr(regeneratorRuntime.mark(function e(){var t,n,r,a,o,i,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.userId,r=t.focus,e.next=3,G("blob","image/png,image/jpeg,image/gif");case 3:if(!((a=e.sent).length>B.a.maxImageSize)){e.next=6;break}return e.abrupt("return",T.a.error("Impossibile impostare il ritratto di gruppo, selezionare un'immagine di dimensioni inferiori a 1 MB"));case 6:return e.next=8,Object(Ce.a)("uploadToken",{});case 8:o=e.sent,i=tr(o,2),s=i[0],c=i[1],s||m.upload(a.result,"GroupAvatar/"+n+"_"+Date.now(),c.token,{useCdnDomain:!0},{}).subscribe({error:function(e){console.error(e),T.a.error("Impossibile caricare foto di gruppo")},complete:function(){var e=rr(regeneratorRuntime.mark(function e(t){var n,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=""+(c.urlPrefix+t.key),e.next=3,Object(Ce.a)("changeGroupAvatar",{groupId:r,avatar:n});case 3:o=e.sent,i=tr(o,1),i[0]||(w.a.setGroupAvatar(r,URL.createObjectURL(a.result)),T.a.success("Modificata la foto di gruppo con successo"));case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()});case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"leaveGroup",value:function(){var e=rr(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.focus,e.next=3,Object(Ce.a)("leaveGroup",{groupId:t});case 3:n=e.sent,r=tr(n,1),r[0]||(this.closeGroupInfo(),w.a.removeLinkman(t),T.a.success("Uscito dal gruppo con successo"));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderMembers",value:function(){return this.props.members.map(function(e){return i.a.createElement("div",{key:e.get("_id")},i.a.createElement("div",null,i.a.createElement(_,{size:24,src:e.getIn(["user","avatar"])}),i.a.createElement("p",null,e.getIn(["user","username"]))),i.a.createElement(ut,{placement:"top",trigger:["hover"],overlay:i.a.createElement("span",null,e.get("environment"))},i.a.createElement("p",null,e.get("browser"),"  ","Windows Server 2008 R2 / 7"===e.get("os")?"Windows 7":e.get("os"))))})}},{key:"render",value:function(){var e=this,t=this.state,n=t.groupInfoDialog,r=t.userInfoDialog,a=t.userInfo,o=t.nosAddress,s=this.props,c=s.userId,u=s.creator,l=s.avatar,p=s.type,f=s.to,d=s.name,m="NOS"in window&&o;return i.a.createElement("div",{className:"module-main-chat"},i.a.createElement(Ot,{onShowInfo:"group"===p?this.groupInfoDialog:this.showUserInfoDialog.bind(this,{_id:f,username:d,avatar:l})}),i.a.createElement(Jt,{showUserInfoDialog:this.showUserInfoDialog}),i.a.createElement(er,null),i.a.createElement("div",{className:"float-panel info "+(n?"show":"hide")},i.a.createElement("p",null,"Informazioni sul gruppo"),i.a.createElement("div",null,i.a.createElement("div",{className:"feature",style:{display:c&&c===u?"none":"block"}},i.a.createElement("p",null,"funzione"),i.a.createElement(N.a,{type:"danger",onClick:this.leaveGroup},"Lascia il gruppo")),m&&i.a.createElement("div",{className:"feature",style:{display:"block"}},i.a.createElement("p",null,"Partecipa al crowdfunding"),i.a.createElement("p",null," Address : ",o," "),i.a.createElement("br",null),i.a.createElement("p",null," quantità :  "),i.a.createElement(je.a,{ref:function(t){return e.assetQty=t}}),i.a.createElement("br",null),i.a.createElement(ze,{trigger:["click"],overlay:this.nOSDropdown,animation:"slide-up",placement:"topLeft"},i.a.createElement(P.a,{className:"send",width:44,height:44,icon:"send",iconSize:32}))),i.a.createElement("div",{className:"online-members"},i.a.createElement("p",null,"Persone in linea"),i.a.createElement("div",null,this.renderMembers())))),r?i.a.createElement(Qe,{visible:r,userInfo:a,onClose:this.closeUserInfoDialog}):"")}}]),t}(),Jn.propTypes={focus:l.a.string,members:ue.a.list,userId:l.a.string,creator:l.a.string,avatar:l.a.string,to:l.a.string,name:l.a.string,type:l.a.string,nosAddress:l.a.string},ar((Wn=Qn).prototype,"handleFeatureMenuClick",[f.a],Object.getOwnPropertyDescriptor(Wn.prototype,"handleFeatureMenuClick"),Wn.prototype),ar(Wn.prototype,"groupInfoDialog",[f.a],Object.getOwnPropertyDescriptor(Wn.prototype,"groupInfoDialog"),Wn.prototype),ar(Wn.prototype,"closeGroupInfo",[f.a],Object.getOwnPropertyDescriptor(Wn.prototype,"closeGroupInfo"),Wn.prototype),ar(Wn.prototype,"showUserInfoDialog",[f.a],Object.getOwnPropertyDescriptor(Wn.prototype,"showUserInfoDialog"),Wn.prototype),ar(Wn.prototype,"closeUserInfoDialog",[f.a],Object.getOwnPropertyDescriptor(Wn.prototype,"closeUserInfoDialog"),Wn.prototype),ar(Wn.prototype,"changeGroupAvatar",[f.a],Object.getOwnPropertyDescriptor(Wn.prototype,"changeGroupAvatar"),Wn.prototype),ar(Wn.prototype,"leaveGroup",[f.a],Object.getOwnPropertyDescriptor(Wn.prototype,"leaveGroup"),Wn.prototype),Wn)),sr=Object(c.b)(function(e){if(!!!e.getIn(["user","_id"]))return{userId:"",focus:e.getIn(["user","linkmans",0,"_id"]),creator:"",avatar:e.getIn(["user","linkmans",0,"avatar"]),members:e.getIn(["user","linkmans",0,"members"])||se.a.List()};var t=e.get("focus"),n=e.getIn(["user","linkmans"]).find(function(e){return e.get("_id")===t});return{userId:e.getIn(["user","_id"]),focus:t,type:n.get("type"),creator:n.get("creator"),to:n.get("to"),name:n.get("name"),avatar:n.get("avatar"),members:n.get("members")||se.a.fromJS([]),nosAddress:n.get("nosAddress")}})(ir),cr=(n(721),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}());var ur=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/chatPanel/ChatPanel.jsx",components:{ChatPanel:{displayName:"ChatPanel"}},locals:[],imports:[]});var lr,pr=function(e){return function(t){return ur(t,e)}}("ChatPanel")(function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),cr(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"module-main-chatPanel"},i.a.createElement(st,null),i.a.createElement(sr,null))}}]),t}()),fr=(n(719),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}());var dr=a()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/Main.jsx",components:{Main:{displayName:"Main"}},locals:[],imports:[]});var mr=function(e){return function(t){return dr(t,e)}}("Main")(Object(s.immutableRenderDecorator)(lr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),fr(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"module-main"},i.a.createElement(oe,null),i.a.createElement(pr,null))}}]),t}())||lr);t.a=mr},296:function(e,t,n){"use strict";var r,a=n(11),o=n.n(a),i=n(0),s=n.n(i),c=n(5),u=n.n(c),l=n(38),p=n.n(l),f=n(28),d=n(8),m=n(33),h=n(41),g=n(14),y=(n(717),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}());function v(e,t,n,r,a){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var b=o()({filename:"/home/massimiliano/githubs/fiora/client/modules/main/login/Login.jsx",components:{Login:{displayName:"Login"}},locals:[],imports:[]});var w,k=(w="Login",function(e){return b(e,w)})((v((r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),y(t,[{key:"handleLogin",value:function(){f.a.emit("login",{username:this.username.getValue(),password:this.password.getValue(),os:p.a.os.family,browser:p.a.name,environment:p.a.description},function(e){"string"==typeof e?g.a.error(e):(d.a.setUser(e),d.a.closeLoginDialog(),window.localStorage.setItem("token",e.token))})}},{key:"handleRegister",value:function(){var e=this,t=null;!!window.NOS&&!!window.NOS.V1?window.NOS.V1.getAddress().then(function(n){t=n,f.a.emit("register",{username:e.username.getValue(),password:e.password.getValue(),neoAddress:t,os:p.a.os.family,browser:p.a.name,environment:p.a.description},function(e){"string"==typeof e?g.a.error(e):(g.a.success("Utente creato con successo"),d.a.setUser(e),d.a.closeLoginDialog(),window.localStorage.setItem("token",e.token))})}).catch(function(e){return alert("Error: "+e.message)}):f.a.emit("register",{username:this.username.getValue(),password:this.password.getValue(),neoAddress:null,os:p.a.os.family,browser:p.a.name,environment:p.a.description},function(e){"string"==typeof e?g.a.error(e):(g.a.success("Utente creato con successo"),d.a.setUser(e),d.a.closeLoginDialog(),window.localStorage.setItem("token",e.token))})}},{key:"renderLogin",value:function(){var e=this;return s.a.createElement("div",{className:"pane"},s.a.createElement("h3",null,"Utente"),s.a.createElement(h.a,{ref:function(t){return e.username=t}}),s.a.createElement("h3",null,"Password"),s.a.createElement(h.a,{type:"password",ref:function(t){return e.password=t}}),s.a.createElement("button",{onClick:this.handleLogin},"Log in"))}},{key:"renderRegister",value:function(){var e=this;return s.a.createElement("div",{className:"pane"},s.a.createElement("h3",null,"Utente"),s.a.createElement(h.a,{ref:function(t){return e.username=t}}),s.a.createElement("h3",null,"Password"),s.a.createElement(h.a,{type:"password",ref:function(t){return e.password=t}}),s.a.createElement("button",{onClick:this.handleRegister},"Registrati"))}},{key:"render",value:function(){return s.a.createElement(m.d,{className:"main-login",defaultActiveKey:"login",renderTabBar:function(){return s.a.createElement(m.a,null)},renderTabContent:function(){return s.a.createElement(m.b,null)}},s.a.createElement(m.c,{tab:"Log in",key:"login"},this.renderLogin()),s.a.createElement(m.c,{tab:"Log on",key:"register"},this.renderRegister()))}}]),t}()).prototype,"handleLogin",[u.a],Object.getOwnPropertyDescriptor(r.prototype,"handleLogin"),r.prototype),v(r.prototype,"handleRegister",[u.a],Object.getOwnPropertyDescriptor(r.prototype,"handleRegister"),r.prototype),r));t.a=k},300:function(e,t,n){"use strict";(function(e){var r,a,o=n(11),i=n.n(o),s=n(0),c=n.n(s),u=n(299),l=n(25),p=n(2),f=n.n(p),d=(n(748),n(8)),m=n(37),h=n(295),g=n(296),y=(n(715),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}());var v=i()({filename:"/home/massimiliano/githubs/fiora/client/App.jsx",components:{App:{displayName:"App"}},locals:[],imports:[]});var b,w=(b="App",function(e){return v(e,b)})((a=r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={width:t.getWidth(),height:.85,resize:0,backgroundWidth:window.innerWidth,backgroundHeight:window.innerHeight},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),y(t,null,[{key:"getWidth",value:function(){var e=.6;return window.innerWidth<1e3?e=.9:window.innerWidth<1300?e=.8:window.innerWidth<1600&&(e=.7),e}}]),y(t,[{key:"componentDidMount",value:function(){var e=this,n=new Image;n.onload=function(){e.setState({backgroundWidth:Math.max(n.width,window.innerWidth),backgroundHeight:Math.max(n.height,window.innerHeight)})},n.src=this.props.backgroundImage,window.onresize=function(){e.setState({resize:e.state.resize+1,width:t.getWidth()})}}},{key:"render",value:function(){var e=this.props.showLoginDialog;return c.a.createElement("div",{className:"app",style:this.style},c.a.createElement("div",{className:"blur",style:this.blurStyle}),c.a.createElement("div",{className:"child",style:this.childStyle},c.a.createElement(h.a,null)),c.a.createElement(m.a,{visible:e,closable:!1,onClose:d.a.closeLoginDialog},c.a.createElement(g.a,null)))}},{key:"style",get:function(){var e=this.state,t=e.backgroundWidth,n=e.backgroundHeight;return{backgroundImage:"url("+this.props.backgroundImage+")",backgroundSize:t+"px "+n+"px",backgroundRepeat:"no-repeat"}}},{key:"blurStyle",get:function(){var e=this.state,t=e.width,n=e.height,r=window,a=r.innerWidth,o=r.innerHeight;return Object.assign({backgroundPosition:-(1-t)*a/2+"px "+-(1-n)*o/2+"px"},this.childStyle,this.style)}},{key:"childStyle",get:function(){var e=this.state,t=e.width,n=e.height;return{width:100*t+"%",height:100*n+"%",position:"absolute",left:(1-t)/2*100+"%",top:(1-n)/2*100+"%"}}}]),t}(),r.propTypes={showLoginDialog:f.a.bool,backgroundImage:f.a.string},a));t.a=Object(l.b)(function(e){return{showLoginDialog:e.getIn(["ui","showLoginDialog"]),backgroundImage:e.getIn(["ui","backgroundImage"])}})(Object(u.hot)(e)(w))}).call(this,n(264)(e))},304:function(e,t,n){"use strict";n.r(t);n(636);var r=n(0),a=n.n(r),o=n(12),i=n.n(o),s=n(25),c=n(38),u=n.n(c),l=(n(168),n(19)),p=n(300),f=n(97),d=n(8),m=n(28);n(204);var h,g=n(72),y=n.n(g),v=n(84),b=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),w=(h=k(regeneratorRuntime.mark(function e(){var t,n,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.a)("guest",{os:u.a.os.family,browser:u.a.name,environment:u.a.description});case 2:t=e.sent,n=b(t,2),r=n[0],a=n[1],r||d.a.setGuest(a);case 7:case"end":return e.stop()}},e,this)})),function(){return h.apply(this,arguments)});function k(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}!window.Notification||"default"!==window.Notification.permission&&"denied"!==window.Notification.permission||window.Notification.requestPermission();var E="focus";window.onfocus=function(){return E="focus"},window.onblur=function(){return E="blur"},m.a.on("connect",k(regeneratorRuntime.mark(function e(){var t,n,r,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=window.localStorage.getItem("token"))){e.next=11;break}return e.next=4,Object(l.a)("loginByToken",{token:t,os:u.a.os.family,browser:u.a.name,environment:u.a.description},{toast:!1});case 4:n=e.sent,r=b(n,2),a=r[0],o=r[1],a?w():d.a.setUser(o),e.next=12;break;case 11:w();case 12:case"end":return e.stop()}},e,void 0)}))),m.a.on("disconnect",function(){d.a.disconnect()}),m.a.on("message",function(e){Object(v.a)(e);var t=f.a.getState(),n=t.getIn(["user","linkmans"]).find(function(t){return t.get("_id")===e.to}),r="";if(n)d.a.addLinkmanMessage(e.to,e),r="group"===n.get("type")?e.from.username+" in "+n.get("name")+" di a tutti:":e.from.username+"  dice:";else{var a={_id:y()(t.getIn(["user","_id"]),e.from._id),type:"temporary",createTime:Date.now(),avatar:e.from.avatar,name:e.from.username,messages:[],unread:1};d.a.addLinkman(a),r=e.from.username+"  dice:",Object(l.a)("getLinkmanHistoryMessages",{linkmanId:a._id}).then(function(e){var t=b(e,2),n=t[0],r=t[1];n||d.a.addLinkmanMessages(a._id,r)})}"blur"===E&&t.getIn(["ui","notificationSwitch"])&&function(e,t,n,r="tag",a=3e3){if(window.Notification&&"granted"===window.Notification.permission){const o=new window.Notification(e,{icon:t,body:n,tag:r});o.onclick=function(){window.blur(),window.focus(),this.close()},setTimeout(o.close.bind(o),a)}}(r,e.from.avatar,"text"===e.type?e.content:"["+e.type+"]",Math.random())}),i.a.render(a.a.createElement(s.a,{store:f.a},a.a.createElement(p.a,null)),document.getElementById("app"))},306:function(e,t){e.exports={addParam(e,t){let n=e;for(const e in t)-1===n.indexOf("?")?n+=`?${e}=${t[e]}`:n+=`&${e}=${t[e]}`;return n}}},31:function(e,t,n){"use strict";var r,a,o=n(11),i=n.n(o),s=n(0),c=n.n(s),u=n(2),l=n.n(u),p=(n(750),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}());var f=i()({filename:"/home/massimiliano/githubs/fiora/client/components/Button.jsx",components:{Button:{displayName:"Button"}},locals:[],imports:[]});var d,m=(d="Button",function(e){return f(e,d)})((a=r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),p(t,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.children,r=e.type;return c.a.createElement("button",{className:"component-button "+r,onClick:t},n)}}]),t}(),r.propTypes={onClick:l.a.func,children:l.a.string,type:l.a.string},r.defaultProps={type:"primary"},a));t.a=m},311:function(e,t,n){const r=new(n(310).FilterXSS)({whiteList:{}});e.exports=function(e){return r.process(e)}},314:function(e,t,n){e.exports=n.p+"img/baidu.bd067c14.png"},315:function(e,t,n){e.exports=n.p+"img/31.04c60253.jpeg"},316:function(e,t,n){e.exports=n.p+"img/30.eaa81a52.jpeg"},317:function(e,t,n){e.exports=n.p+"img/29.4a9e561c.jpeg"},318:function(e,t,n){e.exports=n.p+"img/28.48639c37.jpeg"},319:function(e,t,n){e.exports=n.p+"img/27.f9676d1b.jpeg"},32:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(31),i=(n(750),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}());var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["a"]),i(t,[{key:"render",value:function(){var e=this.props,t=e.width,n=e.height,r=e.icon,o=e.iconSize,i=e.onClick,s=e.style;return a.a.createElement("div",{className:"component-iconButton",style:Object.assign({width:t,height:n},s),onClick:i},a.a.createElement("i",{className:"iconfont icon-"+r,style:{fontSize:o,lineHeight:n+"px"}}))}}]),t}();t.a=s},320:function(e,t,n){e.exports=n.p+"img/26.e84aaad7.jpeg"},321:function(e,t,n){e.exports=n.p+"img/25.ac298da5.png"},322:function(e,t,n){e.exports=n.p+"img/24.ea98e616.jpeg"},323:function(e,t,n){e.exports=n.p+"img/23.9ca0c06c.jpeg"},324:function(e,t,n){e.exports=n.p+"img/22.4293e018.jpeg"},325:function(e,t,n){e.exports=n.p+"img/21.cd1316e1.jpeg"},326:function(e,t,n){e.exports=n.p+"img/20.c71866c4.jpeg"},327:function(e,t,n){e.exports=n.p+"img/19.cf91c08a.jpeg"},328:function(e,t,n){e.exports=n.p+"img/18.688d4f9d.jpeg"},329:function(e,t,n){e.exports=n.p+"img/17.aee8dd1b.jpeg"},33:function(e,t,n){"use strict";var r=n(144);n.d(t,"d",function(){return r.b}),n.d(t,"c",function(){return r.a});var a=n(215),o=n.n(a);n.d(t,"b",function(){return o.a});var i=n(214),s=n.n(i);n.d(t,"a",function(){return s.a});n(742),n(750)},330:function(e,t,n){e.exports=n.p+"img/16.b8e0fffa.jpeg"},331:function(e,t,n){e.exports=n.p+"img/15.53f3213a.jpeg"},332:function(e,t,n){e.exports=n.p+"img/14.a2349131.jpeg"},333:function(e,t,n){e.exports=n.p+"img/13.7bbefb39.jpeg"},334:function(e,t,n){e.exports=n.p+"img/12.2104018b.jpeg"},335:function(e,t,n){e.exports=n.p+"img/11.a54e3ee0.jpeg"},336:function(e,t,n){e.exports=n.p+"img/10.9deadc36.jpeg"},337:function(e,t,n){e.exports=n.p+"img/9.f65cab5c.jpeg"},338:function(e,t,n){e.exports=n.p+"img/8.963a62f9.jpeg"},339:function(e,t,n){e.exports=n.p+"img/7.48dd5e2a.jpg"},340:function(e,t,n){e.exports=n.p+"img/6.3c252362.jpeg"},341:function(e,t,n){e.exports=n.p+"img/5.a533152a.jpg"},342:function(e,t,n){e.exports=n.p+"img/4.9920e57a.jpeg"},343:function(e,t,n){e.exports=n.p+"img/3.ea160741.jpeg"},344:function(e,t,n){e.exports=n.p+"img/2.699255c5.jpeg"},345:function(e,t,n){e.exports=n.p+"img/1.4b49c932.gif"},346:function(e,t,n){e.exports=n.p+"img/0.798c29cd.jpg"},37:function(e,t,n){"use strict";var r=n(293);n(746),n(750);t.a=r.a},394:function(e,t,n){e.exports=n.p+"audio/huaji.3a3d8c0c.mp3"},395:function(e,t,n){e.exports=n.p+"audio/momo.ac1c574b.mp3"},396:function(e,t,n){e.exports=n.p+"audio/mobileqq.97ba874b.mp3"},397:function(e,t,n){e.exports=n.p+"audio/pcqq.0964f25d.mp3"},398:function(e,t,n){e.exports=n.p+"audio/apple.58a86d14.mp3"},399:function(e,t,n){e.exports=n.p+"audio/default.815f7b3e.mp3"},41:function(e,t,n){"use strict";var r,a,o,i=n(11),s=n.n(i),c=n(0),u=n.n(c),l=n(2),p=n.n(l),f=n(5),d=n.n(f),m=n(32),h=(n(750),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}());function g(e,t,n,r,a){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var y=s()({filename:"/home/massimiliano/githubs/fiora/client/components/Input.jsx",components:{Input:{displayName:"Input"}},locals:[],imports:[]});var v,b=(v="Input",function(e){return y(e,v)})((o=a=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return o.state={value:""},o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c["Component"]),h(t,[{key:"getValue",value:function(){return this.state.value.trim()}},{key:"clear",value:function(){this.setState({value:""})}},{key:"handleInput",value:function(e){this.setState({value:e.target.value})}},{key:"handleClickClear",value:function(){this.setState({value:""}),this.input.focus()}},{key:"handleKeyDown",value:function(e){var t=this.props.onEnter;"Enter"===e.key&&t&&t(this.state.value)}},{key:"handleIMEStart",value:function(){this.lockEnter=!0}},{key:"handleIMEEnd",value:function(){this.lockEnter=!1}},{key:"render",value:function(){var e=this,t=this.props.type,n=this.state.value;return u.a.createElement("div",{className:"component-chat"},u.a.createElement("input",{type:t,value:n,onInput:this.handleInput,ref:function(t){return e.input=t},onKeyDown:this.handleKeyDown,onCompositionStart:this.handleIMEStart,onCompositionEnd:this.handleIMEEnd}),u.a.createElement(m.a,{width:32,height:32,iconSize:18,icon:"clear",onClick:this.handleClickClear}))}}]),t}(),a.propTypes={type:p.a.string,onEnter:p.a.func},a.defaultProps={type:"text"},g((r=o).prototype,"handleInput",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"handleInput"),r.prototype),g(r.prototype,"handleClickClear",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"handleClickClear"),r.prototype),g(r.prototype,"handleKeyDown",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"handleKeyDown"),r.prototype),g(r.prototype,"handleIMEStart",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"handleIMEStart"),r.prototype),g(r.prototype,"handleIMEEnd",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"handleIMEEnd"),r.prototype),r));t.a=b},637:function(e,t,n){e.exports=n.p+"img/background.e7cc1169.png"},641:function(e,t){},715:function(e,t){},717:function(e,t){},719:function(e,t){},72:function(e,t){e.exports=function(e,t){return e<t?e+t:t+e}},721:function(e,t){},724:function(e,t){},736:function(e,t){},744:function(e,t){},750:function(e,t){},8:function(e,t,n){"use strict";var r,a,o=n(19),i=n(84),s=n(97),c=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=(r=f(regeneratorRuntime.mark(function e(t){var n,r,a,s,u,l,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.groups.forEach(function(e){Object.assign(e,{type:"group",unread:0,messages:[],members:[]})}),t.friends.forEach(function(e){Object.assign(e,{type:"friend",_id:d(e.from,e.to._id),messages:[],unread:0,avatar:e.to.avatar,name:e.to.username,to:e.to._id})}),n=[].concat(p(t.groups),p(t.friends)),m({type:"SetUser",user:{_id:t._id,avatar:t.avatar,username:t.username,linkmans:n}}),h(),r=[].concat(p(t.groups.map(function(e){return e._id})),p(t.friends.map(function(e){return e._id}))),e.next=8,Object(o.a)("getLinkmansLastMessages",{linkmans:r});case 8:for(f in a=e.sent,s=c(a,2),u=s[0],l=s[1])l[f].forEach(function(e){return Object(i.a)(e)});u||m({type:"SetLinkmanMessages",messages:l});case 14:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)}),l=(a=f(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.messages.forEach(function(e){return Object(i.a)(e)}),m({type:"SetDeepValue",keys:["user"],value:{linkmans:[Object.assign(t,{type:"group",unread:0,members:[]})]}});case 2:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)});function p(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function f(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}var d=n(72),m=s.a.dispatch;function h(){m({type:"SetDeepValue",keys:["connect"],value:!0})}t.a={setUser:u,setGuest:l,connect:h,disconnect:function(){m({type:"SetDeepValue",keys:["connect"],value:!1})},logout:function(){m({type:"Logout"})},setAvatar:function(e){m({type:"SetAvatar",avatar:e})},setFocus:function(e){m({type:"SetFocus",linkmanId:e})},setGroupMembers:function(e,t){m({type:"SetGroupMembers",groupId:e,members:t})},setGroupAvatar:function(e,t){m({type:"SetGroupAvatar",groupId:e,avatar:t})},addLinkman:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"group"===e.type&&(e.members=[],e.messages=[],e.unread=0),m({type:"AddLinkman",linkman:e,focus:t})},removeLinkman:function(e){m({type:"RemoveLinkman",linkmanId:e})},setFriend:function(e,t,n){m({type:"SetFriend",linkmanId:e,from:t,to:n})},addLinkmanMessage:function(e,t){m({type:"AddLinkmanMessage",linkmanId:e,message:t})},addLinkmanMessages:function(e,t){t.forEach(function(e){return Object(i.a)(e)}),m({type:"AddLinkmanMessages",linkmanId:e,messages:t})},updateSelfMessage:function(e,t,n){m({type:"UpdateSelfMessage",linkmanId:e,messageId:t,message:n})},showLoginDialog:function(){m({type:"SetDeepValue",keys:["ui","showLoginDialog"],value:!0})},closeLoginDialog:function(){m({type:"SetDeepValue",keys:["ui","showLoginDialog"],value:!1})},setPrimaryColor:function(e){m({type:"SetDeepValue",keys:["ui","primaryColor"],value:e}),window.localStorage.setItem("primaryColor",e)},setPrimaryTextColor:function(e){m({type:"SetDeepValue",keys:["ui","primaryTextColor"],value:e}),window.localStorage.setItem("primaryTextColor",e)},setBackgroundImage:function(e){m({type:"SetDeepValue",keys:["ui","backgroundImage"],value:e}),window.localStorage.setItem("backgroundImage",e)},setSound:function(e){m({type:"SetDeepValue",keys:["ui","sound"],value:e}),window.localStorage.setItem("sound",e)},setSoundSwitch:function(e){m({type:"SetDeepValue",keys:["ui","soundSwitch"],value:e}),window.localStorage.setItem("soundSwitch",e)},setNotificationSwitch:function(e){m({type:"SetDeepValue",keys:["ui","notificationSwitch"],value:e}),window.localStorage.setItem("notificationSwitch",e)},setVoiceSwitch:function(e){m({type:"SetDeepValue",keys:["ui","voiceSwitch"],value:e}),window.localStorage.setItem("voiceSwitch",e)},setNosAddress:function(e){m({type:"SetDeepValue",keys:["ui","showNosAddress"],value:e}),window.localStorage.setItem("showNosAddress",e)}}},83:function(e,t,n){"use strict";function r(e,t){let n="";for(let r=0;r<=10;r++)n+=`--primary-color-${r}:rgba(${e}, ${r/10});--primary-color-${r}_5:rgba(${e}, ${(r+.5)/10});--primary-text-color-${r}:rgba(${t}, ${r/10});`;document.documentElement.style.cssText+=n}n.d(t,"a",function(){return r})},84:function(e,t,n){"use strict";function r(e){if("5adad39555703565e7903f79"===e.from._id)try{const t=JSON.parse(e.content);e.from.tag=t.source,e.from.avatar=t.avatar,e.from.username=t.username,e.type=t.type,e.content=t.content}catch(e){console.warn("Impossibile risolvere il messaggio del robot10",e)}}n.d(t,"a",function(){return r})},97:function(e,t,n){"use strict";var r=n(127),a=n(24),o=n.n(a),i=n(83),s=n(29),c=window.localStorage.getItem("primaryColor")||s.a.primaryColor,u=window.localStorage.getItem("primaryTextColor")||s.a.primaryTextColor;Object(i.a)(c,u);var l=window.localStorage.getItem("backgroundImage");if(!l){l=s.a.backgroundImage;var p=new Image;p.crossOrigin="Anonymous",p.onload=function(){var e=document.createElement("canvas");e.width=p.width,e.height=p.height,e.getContext("2d").drawImage(p,0,0);var t=e.toDataURL("image/png");window.localStorage.setItem("backgroundImage",t)},p.src=l}var f=window.localStorage.getItem("sound")||s.a.sound,d=window.localStorage.getItem("soundSwitch")||"true";d="true"===d;var m=window.localStorage.getItem("notificationSwitch")||"true";m="true"===m;var h=window.localStorage.getItem("voiceSwitch")||"true";h="true"===h;var g=o.a.fromJS({user:null,focus:"",connect:!0,ui:{showLoginDialog:!1,primaryColor:c,primaryTextColor:u,backgroundImage:l,sound:f,soundSwitch:d,notificationSwitch:m,voiceSwitch:h}});var y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments[1];switch(t.type){case"Logout":var n=g,r=!0,a=!1,i=void 0;try{for(var s,c=[["ui","primaryColor"],["ui","primaryTextColor"],["ui","backgroundImage"],["ui","sound"]][Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var u=s.value;n=n.setIn(u,e.getIn(u))}}catch(e){a=!0,i=e}finally{try{!r&&c.return&&c.return()}finally{if(a)throw i}}return n;case"SetDeepValue":return e.setIn(t.keys,o.a.fromJS(t.value));case"SetUser":return e.set("user",o.a.fromJS(t.user)).set("focus",t.user.linkmans[0]._id);case"SetLinkmanMessages":var l=e.getIn(["user","linkmans"]).map(function(e){return e.set("messages",o.a.fromJS(t.messages[e.get("_id")]))}).sort(function(e,t){var n=e.get("messages"),r=t.get("messages"),a=n.size>0?n.get(n.size-1).get("createTime"):e.get("createTime"),o=r.size>0?r.get(r.size-1).get("createTime"):t.get("createTime");return new Date(a)<new Date(o)});return e.setIn(["user","linkmans"],l).set("focus",l.getIn([0,"_id"]));case"SetGroupMembers":var p=e.getIn(["user","linkmans"]).findIndex(function(e){return e.get("_id")===t.groupId});return e.setIn(["user","linkmans",p,"members"],o.a.fromJS(t.members));case"SetGroupAvatar":var f=e.getIn(["user","linkmans"]).findIndex(function(e){return e.get("_id")===t.groupId});return e.setIn(["user","linkmans",f,"avatar"],t.avatar);case"SetFocus":var d=e.getIn(["user","linkmans"]).findIndex(function(e){return e.get("_id")===t.linkmanId});return e.set("focus",t.linkmanId).setIn(["user","linkmans",d,"unread"],0);case"SetFriend":var m=e.getIn(["user","linkmans"]).findIndex(function(e){return e.get("_id")===t.linkmanId});return e.updateIn(["user","linkmans",m],function(e){return e.set("type","friend").set("from",t.from).set("to",t.to).set("unread",0)}).set("focus",t.linkmanId);case"AddLinkman":var h=e.updateIn(["user","linkmans"],function(e){return e.unshift(o.a.fromJS(t.linkman))});return t.focus?h.set("focus",t.linkman._id):h;case"RemoveLinkman":var y=e.getIn(["user","linkmans"]).findIndex(function(e){return e.get("_id")===t.linkmanId}),v=e.updateIn(["user","linkmans"],function(e){return e.delete(y)});return v.set("focus",v.getIn(["user","linkmans",0,"_id"]));case"AddLinkmanMessage":var b=e.getIn(["user","linkmans"]).findIndex(function(e){return e.get("_id")===t.linkmanId}),w=e.getIn(["user","linkmans",b]),k=0;return e.get("focus")!==w.get("_id")&&(k=w.get("unread")+1),e.updateIn(["user","linkmans"],function(e){return e.delete(b).unshift(w.update("messages",function(e){return e.push(o.a.fromJS(t.message))}).set("unread",k))});case"AddLinkmanMessages":var E=e.getIn(["user","linkmans"]).findIndex(function(e){return e.get("_id")===t.linkmanId});return e.updateIn(["user","linkmans",E],function(e){return e.update("messages",function(e){return o.a.fromJS(t.messages).concat(e)})});case"UpdateSelfMessage":var O=e.getIn(["user","linkmans"]).findIndex(function(e){return e.get("_id")===t.linkmanId});return e.updateIn(["user","linkmans",O,"messages"],function(e){var n=e.findLastIndex(function(e){return e.get("_id")===t.messageId});return e.update(n,function(e){return e.mergeDeep(o.a.fromJS(t.message))})});case"SetAvatar":var S=e.getIn(["user","_id"]);return e.setIn(["user","avatar"],t.avatar).updateIn(["user","linkmans"],function(e){return e.map(function(e){return e.update("messages",function(e){return e.map(function(e){return e.getIn(["from","_id"])===S?e.setIn(["from","avatar"],t.avatar):e})})})});default:return e}},v=Object(r.b)(y,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());t.a=v}});